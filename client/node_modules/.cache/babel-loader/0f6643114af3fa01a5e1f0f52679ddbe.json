{"remainingRequest":"/Users/hervey/Projects/Development/audiomarketplace/node_modules/babel-loader/lib/index.js!/Users/hervey/Projects/Development/audiomarketplace/node_modules/eslint-loader/index.js??ref--13-0!/Users/hervey/Projects/Development/audiomarketplace/src/mixins/AudioFunctions.js","dependencies":[{"path":"/Users/hervey/Projects/Development/audiomarketplace/src/mixins/AudioFunctions.js","mtime":1630835160796},{"path":"/Users/hervey/Projects/Development/audiomarketplace/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hervey/Projects/Development/audiomarketplace/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hervey/Projects/Development/audiomarketplace/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXRoLmxvZzEwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmxvYXQzMi1hcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnVpbnQ4LWFycmF5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuY29weS13aXRoaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5ldmVyeSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbGwiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWx0ZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZnJvbSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmciOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCBTdGF5QXdha2UgZnJvbSAnc3RheWF3YWtlLmpzJzsKaW1wb3J0IHsgSG93bCwgSG93bGVyIH0gZnJvbSAnaG93bGVyJzsKZXhwb3J0IHZhciBBdWRpb0Z1bmN0aW9ucyA9IHsKICBtZXRob2RzOiB7CiAgICAvLyBNb3ZlIHRvIGdlbmVyYWwgZnVuY3Rpb25zIG1peGluCiAgICB0cmltTnVtYmVyOiBmdW5jdGlvbiB0cmltTnVtYmVyKG51bSwgZGVjaW1hbHMpIHsKICAgICAgdmFyIG51bWJlciA9IG51bTsKICAgICAgdmFyIHMgPSBudW0udG9TdHJpbmcoKTsKICAgICAgdmFyIGQgPSBzLnNwbGl0KCIuIik7CgogICAgICBpZiAoZC5sZW5ndGggPiAxKSB7CiAgICAgICAgZFsxXSA9IGRbMV0uc3Vic3RyaW5nKDAsIGRlY2ltYWxzKTsKICAgICAgICBudW1iZXIgPSBwYXJzZUZsb2F0KGQuam9pbigiLiIpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bWJlcjsKICAgIH0sCiAgICAvLyBLZWVwIGhlcmUKICAgIHBsYXlTb3VuZDogZnVuY3Rpb24gcGxheVNvdW5kKGFwcERhdGEsIGl0ZW0pIHsKICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICBsb2FkTmV3OiB0cnVlLAogICAgICAgIG1ldGhvZHNSZWZlcmVuY2U6IHRoaXMsCiAgICAgICAgdGltZURhdGE6IHsKICAgICAgICAgIHN0YXJ0OiBpdGVtLnRyaW0gJiYgaXRlbS50cmltLnRpbWUgPyBpdGVtLnRyaW0udGltZS5zdGFydCA6IDAsCiAgICAgICAgICBkdXJhdGlvbjogaXRlbS50cmltICYmIGl0ZW0udHJpbS50aW1lID8gaXRlbS50cmltLnRpbWUuZHVyYXRpb24gOiBpdGVtLmR1cmF0aW9uCiAgICAgICAgfQogICAgICB9OwoKICAgICAgXy5tZXJnZShkYXRhLCBvcHRpb25zKTsKCiAgICAgIGlmIChpdGVtLl9pZCA9PT0gYXBwRGF0YS5jdXJyZW50SXRlbS5faWQpIHsKICAgICAgICAvLyBMb2FkZWQgc291bmQgaXMgdGhlIHNhbWUgICAgICAKICAgICAgICAvLyBUcmltIG1vZGUKICAgICAgICBpZiAoZGF0YS5wbGF5TW9kZSA9PT0gJ3RyaW0nKSB7CiAgICAgICAgICBpZiAoYXBwRGF0YS5jdXJyZW50SXRlbS5maWxlVmVyc2lvbiA9PT0gJ2Z1bGwnKSB7CiAgICAgICAgICAgIC8vIFNob3VsZCBiZSBmdWxsIGZpbGUgdmVyc2lvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZGF0YS5sb2FkTmV3ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBEZWZhdWx0IG1vZGUKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZGF0YS5sb2FkTmV3ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgIH0gLy8gVHJpbSBtb2RlCgoKICAgICAgaWYgKGRhdGEucGxheU1vZGUgPT09ICd0cmltJykgewogICAgICAgIF8uc2V0KGl0ZW0sICd0cmltLnRpbWUnLCBkYXRhLnRpbWVEYXRhKTsKICAgICAgfSAvLyBMb2FkIG5ldyBzb3VuZAoKCiAgICAgIGlmIChkYXRhLmxvYWROZXcgPT09IHRydWUpIHsKICAgICAgICBIb3dsZXIuc3RvcCgpOwogICAgICAgIFZ1ZS5zZXQoaXRlbSwgJ3N0YXR1cycsICdpbml0aWFsJyk7CiAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCAnc3RhdHVzJywgJ2xvYWRpbmcnKTsKICAgICAgICBkYXRhLm1ldGhvZHNSZWZlcmVuY2UubG9hZFNvdW5kKGFwcERhdGEsIGl0ZW0sIGRhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIEFscmVhZHkgcGxheWluZyAgICAgICAgICAgICAgICAKICAgICAgICBpZiAoYXBwRGF0YS5jdXJyZW50SXRlbS5zb3VuZE9iamVjdC5wbGF5aW5nKCkpIHsKICAgICAgICAgIGFwcERhdGEuY3VycmVudEl0ZW0uc291bmRPYmplY3QucGF1c2UoKTsKCiAgICAgICAgICBpZiAoZGF0YS5wbGF5TW9kZSA9PT0gJ3RyaW0nKSB7CiAgICAgICAgICAgIGFwcERhdGEuY3VycmVudEl0ZW0uc291bmRPYmplY3QucGxheSgpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0LnBsYXkoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVDdXJyZW50VGltZTogZnVuY3Rpb24gdXBkYXRlQ3VycmVudFRpbWUoYXBwRGF0YSwgc291bmRPYmplY3QpIHsKICAgICAgdmFyIGN1cnJlbnRUaW1lID0gc291bmRPYmplY3Quc2VlaygpIHx8IDA7CiAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbSwgJ2N1cnJlbnRUaW1lJywgY3VycmVudFRpbWUpOwogICAgfSwKICAgIGxvYWRTb3VuZDogZnVuY3Rpb24gbG9hZFNvdW5kKGFwcERhdGEsIGl0ZW0sIG9wdGlvbnMpIHsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgbWV0aG9kc1JlZmVyZW5jZTogdGhpcwogICAgICB9OwoKICAgICAgaWYgKG9wdGlvbnMpIHsKICAgICAgICBfLm1lcmdlKGRhdGEsIG9wdGlvbnMpOwogICAgICB9CgogICAgICBkYXRhLm1ldGhvZHNSZWZlcmVuY2UucmVzZXRDdXJyZW50U291bmQoYXBwRGF0YSk7IC8vIFJlc2V0IGN1cnJlbnQgc291bmQKCiAgICAgIGRhdGEuZmlsZVZlcnNpb24gPSBkYXRhLnBsYXlNb2RlID09PSAndHJpbScgPyAnZnVsbCcgOiAncHJldmlldyc7IC8vIFNldCBmaWxlIHZlcnNpb24KICAgICAgLy8gQ2hhbmdlIHN0YXRlIGZvciBhdWRpbyBwbGF5ZXIgb3IgcGFyZW50CiAgICAgIC8vIEhpZ2hsaWdodCBjbGlwIHRpbWUgaW4gbWFpbiBwbGF5ZXIKICAgICAgLy8gQ3JlYXRlIHNvdW5kIG9iamVjdAoKICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCAnc291bmRPYmplY3QnLCBuZXcgSG93bCh7CiAgICAgICAgc3JjOiAnLi9kYXRhYmFzZS9hdWRpby8nICsgaXRlbS5faWQgKyAnLycgKyBkYXRhLmZpbGVWZXJzaW9uICsgJy5tcDMnLAogICAgICAgIHZvbHVtZTogMSwKICAgICAgICAvLyBFdmVudHMKICAgICAgICBvbnBsYXk6IGZ1bmN0aW9uIG9ucGxheSgpIHsKICAgICAgICAgIGRhdGEubWV0aG9kc1JlZmVyZW5jZS51cGRhdGVDdXJyZW50VGltZShhcHBEYXRhLCBhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0KTsgLy8gVHJpbSBtb2RlIHNldHRpbmdzCgogICAgICAgICAgaWYgKGl0ZW0ubW9kZSA9PT0gJ2VkaXQnKSB7CiAgICAgICAgICAgIGRhdGEubWV0aG9kc1JlZmVyZW5jZS5zZXRUcmltTW9kZShhcHBEYXRhLCBpdGVtLCAncGxheScpOwogICAgICAgICAgfQoKICAgICAgICAgIFN0YXlBd2FrZS5lbmFibGUoKTsKICAgICAgICAgIGFwcERhdGEuc291bmRPYmplY3RSQUYgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlUHJvZ3Jlc3MuYmluZChhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0KSk7CiAgICAgICAgICBWdWUuc2V0KGl0ZW0sICdzdGF0dXMnLCAncGxheWluZycpOwogICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCAnc3RhdHVzJywgJ3BsYXlpbmcnKTsKICAgICAgICB9LAogICAgICAgIG9ubG9hZDogZnVuY3Rpb24gb25sb2FkKCkgewogICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCAnZHVyYXRpb24nLCBhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0Ll9kdXJhdGlvbik7CiAgICAgICAgICBhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0LnBsYXkoKTsKICAgICAgICB9LAogICAgICAgIG9uZW5kOiBmdW5jdGlvbiBvbmVuZCgpIHsKICAgICAgICAgIFN0YXlBd2FrZS5kaXNhYmxlKCk7CiAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShhcHBEYXRhLnNvdW5kT2JqZWN0UkFGKTsKICAgICAgICAgIFZ1ZS5zZXQoaXRlbSwgJ3N0YXR1cycsICdpbml0aWFsJyk7CiAgICAgICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0sICdzdGF0dXMnLCAnaW5pdGlhbCcpOyAvLyBQbGF5IG5leHQKCiAgICAgICAgICBpZiAoIWRhdGEucGxheU1vZGUgfHwgZGF0YS5wbGF5TW9kZSA9PT0gJ21haW5GZWVkJykgewogICAgICAgICAgICB2YXIgbmV4dEluZGV4ID0gYXBwRGF0YS5tYWluSXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uX2lkID09PSBhcHBEYXRhLmN1cnJlbnRJdGVtLl9pZDsKICAgICAgICAgICAgfSkgKyAxOwoKICAgICAgICAgICAgaWYgKG5leHRJbmRleCA9PT0gYXBwRGF0YS5tYWluSXRlbXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgbmV4dEluZGV4ID0gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGF0YS5tZXRob2RzUmVmZXJlbmNlLnBsYXlTb3VuZChhcHBEYXRhLCBhcHBEYXRhLm1haW5JdGVtc1tuZXh0SW5kZXhdKTsKICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5wbGF5TW9kZSA9PT0gJ3RyaW0nKSB7Ly8gVHJpbSBtb2RlCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbnBhdXNlOiBmdW5jdGlvbiBvbnBhdXNlKCkgewogICAgICAgICAgLy8gVHJpbSBtb2RlIHNldHRpbmdzCiAgICAgICAgICBTdGF5QXdha2UuZGlzYWJsZSgpOwogICAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoYXBwRGF0YS5zb3VuZE9iamVjdFJBRik7CiAgICAgICAgICBWdWUuc2V0KGl0ZW0sICdzdGF0dXMnLCAncGF1c2VkJyk7CiAgICAgICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0sICdzdGF0dXMnLCAncGF1c2VkJyk7CiAgICAgICAgfSwKICAgICAgICBvbnN0b3A6IGZ1bmN0aW9uIG9uc3RvcCgpIHsKICAgICAgICAgIC8vIFRyaW0gbW9kZSBzZXR0aW5ncwogICAgICAgICAgaWYgKGl0ZW0ubW9kZSA9PT0gJ2VkaXQnKSB7CiAgICAgICAgICAgIGRhdGEubWV0aG9kc1JlZmVyZW5jZS5zZXRUcmltTW9kZShhcHBEYXRhLCBpdGVtLCAnc3RvcCcpOwogICAgICAgICAgfQoKICAgICAgICAgIFN0YXlBd2FrZS5kaXNhYmxlKCk7CiAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShhcHBEYXRhLnNvdW5kT2JqZWN0UkFGKTsKICAgICAgICAgIFZ1ZS5zZXQoaXRlbSwgJ3N0YXR1cycsICdwYXVzZWQnKTsKICAgICAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbSwgJ3N0YXR1cycsICdpbml0aWFsJyk7CiAgICAgICAgfSwKICAgICAgICBvbnNlZWs6IGZ1bmN0aW9uIG9uc2VlaygpIHsKICAgICAgICAgIGRhdGEubWV0aG9kc1JlZmVyZW5jZS51cGRhdGVDdXJyZW50VGltZShhcHBEYXRhLCBhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0KTsgLy8gVHJpbSBtb2RlIHNldHRpbmdzCgogICAgICAgICAgaWYgKGl0ZW0ubW9kZSA9PT0gJ2VkaXQnKSB7CiAgICAgICAgICAgIGRhdGEubWV0aG9kc1JlZmVyZW5jZS5zZXRUcmltTW9kZShhcHBEYXRhLCBpdGVtLCAnc2VlaycpOwogICAgICAgICAgfQoKICAgICAgICAgIGFwcERhdGEuc291bmRPYmplY3RSQUYgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlUHJvZ3Jlc3MuYmluZChhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0KSk7CiAgICAgICAgfQogICAgICB9KSk7IC8vIFVwZGF0ZSBjdXJyZW50IG9iamVjdAoKICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCAnX2lkJywgaXRlbS5faWQpOwogICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0sICd0aXRsZScsIGl0ZW0uZWRpdGFibGUudGl0bGUpOwogICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0sICdhdXRob3InLCBpdGVtLmVkaXRhYmxlLmF1dGhvcik7CiAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbSwgJ2ZpbGVWZXJzaW9uJywgZGF0YS5maWxlVmVyc2lvbik7IC8vIEVmZmVjdHMKICAgICAgLy8gQ3JlYXRlIGFuIGFuYWx5c2VyIG5vZGUgaW4gdGhlIEhvd2xlciBXZWJBdWRpbyBjb250ZXh0CgogICAgICB2YXIgY29udGV4dCA9IEhvd2xlci5jdHg7CiAgICAgIHZhciBhdWRpb1NvdXJjZU5vZGUgPSBjb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZShhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0KTsKICAgICAgdmFyIGFuYWx5c2VyID0gY29udGV4dC5jcmVhdGVBbmFseXNlcigpOwogICAgICBhbmFseXNlci5mZnRTaXplID0gMTAyNDsKICAgICAgdmFyIGJ1ZmZlckxlbmd0aCA9IGFuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50OwogICAgICB2YXIgZGF0YUFycmF5OwogICAgICB2YXIgbW9kZSA9IDI7CgogICAgICBpZiAobW9kZSA9PT0gMSkgewogICAgICAgIGRhdGFBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoYW5hbHlzZXIuZmZ0U2l6ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZmZ0U2l6ZSk7CiAgICAgIH0KCiAgICAgIGF1ZGlvU291cmNlTm9kZS5jb25uZWN0KGFuYWx5c2VyKTsKICAgICAgSG93bGVyLm1hc3RlckdhaW4uY29ubmVjdChhbmFseXNlcik7CgogICAgICBmdW5jdGlvbiBnZXRMZXZlbHMoKSB7CiAgICAgICAgdmFyIGxldmVsc0hlcnR6ID0gW107CiAgICAgICAgdmFyIGxldmVsc1BlcmMgPSBbXTsKICAgICAgICB2YXIgc2VjdGlvblNwbGl0ID0gMTY7CiAgICAgICAgdmFyIHNlY3Rpb25zID0gYnVmZmVyTGVuZ3RoIC8gc2VjdGlvblNwbGl0OwoKICAgICAgICBpZiAobW9kZSA9PT0gMSB8fCBtb2RlID09PSAyKSB7CiAgICAgICAgICB2YXIgZmluYWxBcnJheSA9IGRhdGFBcnJheTsKCiAgICAgICAgICBpZiAobW9kZSA9PT0gMikgewogICAgICAgICAgICBmaW5hbEFycmF5ID0gRmxvYXQzMkFycmF5LmZyb20oZGF0YUFycmF5KTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKHZhciBzZWMgPSAwOyBzZWMgPCBzZWN0aW9uczsgc2VjKyspIHsKICAgICAgICAgICAgdmFyIG1pbkJpbiA9IHNlYyAqIHNlY3Rpb25TcGxpdDsKICAgICAgICAgICAgdmFyIG1heEJpbiA9IChzZWMgKyAxKSAqIHNlY3Rpb25TcGxpdDsKICAgICAgICAgICAgdmFyIG51bU9mQmlucyA9IG1heEJpbiAtIG1pbkJpbjsKICAgICAgICAgICAgdmFyIGJpbkl0ZW1zID0gMDsKCiAgICAgICAgICAgIGZvciAodmFyIGkgPSBtaW5CaW47IGkgPCBtYXhCaW47IGkrKykgewogICAgICAgICAgICAgIHZhciBjYWxjTnVtID0gZmluYWxBcnJheVtpXTsKCiAgICAgICAgICAgICAgaWYgKG1vZGUgPT09IDIpIHsKICAgICAgICAgICAgICAgIGNhbGNOdW0gPSAoY2FsY051bSAtIDEyOCkgLyAxMjg7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBiaW5JdGVtcyArPSBNYXRoLnBvdyhjYWxjTnVtLCAyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGhlcnR6ID0gMTAgKiBNYXRoLmxvZzEwKGJpbkl0ZW1zIC8gbnVtT2ZCaW5zKTsKICAgICAgICAgICAgdmFyIHBlcmMgPSAoMTAwICsgaGVydHopLnRvRml4ZWQoKTsKICAgICAgICAgICAgbGV2ZWxzSGVydHoucHVzaChoZXJ0eik7CiAgICAgICAgICAgIGxldmVsc1BlcmMucHVzaChwZXJjKTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIFVwZGF0ZSBsZXZlbHMKCgogICAgICAgIHZhciBsZXZlbHMgPSB7CiAgICAgICAgICAnaGVydHonOiBsZXZlbHNIZXJ0eiwKICAgICAgICAgICdwZXJjJzogbGV2ZWxzUGVyYwogICAgICAgIH07CiAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCAnbGV2ZWxzJywgbGV2ZWxzKTsKICAgICAgICByZXR1cm4gbGV2ZWxzOwogICAgICB9CgogICAgICBmdW5jdGlvbiBkZXRlY3RMZXZlbChvcHRpb25zKSB7CiAgICAgICAgdmFyIGhlcnR6VGVzdCA9IHRydWU7CiAgICAgICAgdmFyIGxldmVscyA9IGdldExldmVscygpOwoKICAgICAgICBpZiAob3B0aW9ucy5tb2RlID09PSAnYW55JykgewogICAgICAgICAgaWYgKG9wdGlvbnMuYWJvdmVMZXZlbCkgewogICAgICAgICAgICB2YXIgYW55QWJvdmUgPSBmYWxzZTsKCiAgICAgICAgICAgIGZvciAodmFyIGxldmVsSW5kZXggPSBvcHRpb25zLmFib3ZlTGV2ZWw7IGxldmVsSW5kZXggPCBsZXZlbHMuaGVydHoubGVuZ3RoOyBsZXZlbEluZGV4KyspIHsKICAgICAgICAgICAgICBpZiAobGV2ZWxzLmhlcnR6W2xldmVsSW5kZXhdID4gb3B0aW9ucy50aHJlc2hvbGQpIHsKICAgICAgICAgICAgICAgIGFueUFib3ZlID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChvcHRpb25zLmV4Y2x1ZGVCZWxvdykgewogICAgICAgICAgICAgIGZvciAodmFyIF9sZXZlbEluZGV4ID0gMDsgX2xldmVsSW5kZXggPCBvcHRpb25zLmV4Y2x1ZGVCZWxvdzsgX2xldmVsSW5kZXgrKykgewogICAgICAgICAgICAgICAgaWYgKGxldmVscy5oZXJ0eltfbGV2ZWxJbmRleF0gPiBvcHRpb25zLnRocmVzaG9sZCkgewogICAgICAgICAgICAgICAgICBhbnlBYm92ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGFueUFib3ZlID09PSBmYWxzZSkgewogICAgICAgICAgICAgIGhlcnR6VGVzdCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBudW1PZkxldmVscyA9IG9wdGlvbnMubWF4TGV2ZWwgLSBvcHRpb25zLm1pbkxldmVsOwogICAgICAgICAgdmFyIGxldmVsSXRlbXMgPSAwOwoKICAgICAgICAgIGZvciAodmFyIF9sZXZlbEluZGV4MiA9IG9wdGlvbnMubWluTGV2ZWw7IF9sZXZlbEluZGV4MiA8IG9wdGlvbnMubWF4TGV2ZWw7IF9sZXZlbEluZGV4MisrKSB7CiAgICAgICAgICAgIGxldmVsSXRlbXMgKz0gbGV2ZWxzLmhlcnR6W19sZXZlbEluZGV4Ml07CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGluY2x1ZGVIZXJ0eiA9IGxldmVsSXRlbXMgLyBudW1PZkxldmVsczsKICAgICAgICAgIHZhciBleGNsdWRlSGVydHo7CgogICAgICAgICAgaWYgKG9wdGlvbnMubWluRXhjbHVkZSkgewogICAgICAgICAgICB2YXIgbnVtT2ZFeExldmVscyA9IG9wdGlvbnMubWF4RXhjbHVkZSAtIG9wdGlvbnMubWluRXhjbHVkZTsKICAgICAgICAgICAgdmFyIGV4TGV2ZWxJdGVtcyA9IDA7CgogICAgICAgICAgICBmb3IgKHZhciBleExldmVsSW5kZXggPSBvcHRpb25zLm1pbkV4Y2x1ZGU7IGV4TGV2ZWxJbmRleCA8IG9wdGlvbnMubWF4RXhjbHVkZTsgZXhMZXZlbEluZGV4KyspIHsKICAgICAgICAgICAgICBleExldmVsSXRlbXMgKz0gbGV2ZWxzLmhlcnR6W2V4TGV2ZWxJbmRleF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGV4Y2x1ZGVIZXJ0eiA9IGV4TGV2ZWxJdGVtcyAvIG51bU9mRXhMZXZlbHM7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGluY2x1ZGVIZXJ0eiA8IG9wdGlvbnMudGhyZXNob2xkKSB7CiAgICAgICAgICAgIGhlcnR6VGVzdCA9IGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChleGNsdWRlSGVydHogJiYgZXhjbHVkZUhlcnR6ID4gb3B0aW9ucy5leFRocmVzaG9sZCkgewogICAgICAgICAgICBoZXJ0elRlc3QgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChoZXJ0elRlc3QgPT09IHRydWUpIHsKICAgICAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbSwgb3B0aW9ucy5uYW1lLCB0cnVlKTsKCiAgICAgICAgICBpZiAoYXBwRGF0YS5jdXJyZW50SXRlbVtvcHRpb25zLm5hbWUgKyAnVGltZXInXSkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQoYXBwRGF0YS5jdXJyZW50SXRlbVtvcHRpb25zLm5hbWUgKyAnVGltZXInXSk7CiAgICAgICAgICB9CgogICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCBvcHRpb25zLm5hbWUgKyAnVGltZXInLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCBvcHRpb25zLm5hbWUsIGZhbHNlKTsKICAgICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLCBvcHRpb25zLm5hbWUgKyAnVGltZXInLCAiIik7CiAgICAgICAgICB9LCBvcHRpb25zLnJlbGVhc2UpKTsgLy8gQmFzcyBzdGVwcwoKICAgICAgICAgIGlmIChvcHRpb25zLmJhc3NTdGVwcykgewogICAgICAgICAgICBpZiAoYXBwRGF0YS5jdXJyZW50SXRlbS5iYXNzU3RlcHMgJiYgYXBwRGF0YS5jdXJyZW50SXRlbS5iYXNzU3RlcHMuY3VycmVudCAhPT0gZmFsc2UpIHsKICAgICAgICAgICAgICBpZiAoYXBwRGF0YS5jdXJyZW50SXRlbS5iYXNzU3RlcHNbJ3RyaWdnZXInXSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLmJhc3NTdGVwcywgJ3RyaWdnZXInLCBmYWxzZSk7IC8vIFRyaWdnZXIgb2ZmCiAgICAgICAgICAgICAgICAvLyBOZXh0IHN0ZXAKCiAgICAgICAgICAgICAgICB2YXIgbmV3U3RlcCA9IGFwcERhdGEuY3VycmVudEl0ZW0uYmFzc1N0ZXBzLmN1cnJlbnQgKyAxID4gb3B0aW9ucy5iYXNzU3RlcHMuY291bnQgPyAwIDogYXBwRGF0YS5jdXJyZW50SXRlbS5iYXNzU3RlcHMuY3VycmVudCArIDE7CiAgICAgICAgICAgICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0uYmFzc1N0ZXBzLCAnY3VycmVudCcsIG5ld1N0ZXApOyAvLyBUcmlnZ2VyIHRpbWVyCgogICAgICAgICAgICAgICAgVnVlLnNldChhcHBEYXRhLmN1cnJlbnRJdGVtLmJhc3NTdGVwcywgJ3RpbWVyJywgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbS5iYXNzU3RlcHMsICd0cmlnZ2VyJywgdHJ1ZSk7IC8vIFRyaWdnZXIgb24KICAgICAgICAgICAgICAgIH0sICcxMDAnKSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbSwgJ2Jhc3NTdGVwcy50cmlnZ2VyJywgZmFsc2UpOyAvLyBUcmlnZ2VyIG9mZgoKICAgICAgICAgICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0sICdiYXNzU3RlcHMnLCB7CiAgICAgICAgICAgICAgICAnY3VycmVudCc6IDAKICAgICAgICAgICAgICB9KTsgLy8gSW5pdGlhbCBzdGVwCiAgICAgICAgICAgICAgLy8gVHJpZ2dlciB0aW1lcgoKICAgICAgICAgICAgICBWdWUuc2V0KGFwcERhdGEuY3VycmVudEl0ZW0uYmFzc1N0ZXBzLCAndGltZXInLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbS5iYXNzU3RlcHMsICd0cmlnZ2VyJywgdHJ1ZSk7IC8vIFRyaWdnZXIgb24KICAgICAgICAgICAgICB9LCAnODcuNScpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHByZXZpb3VzRGVsdGEgPSAwLAogICAgICAgICAgZnBzTGltaXQgPSA2MDsKCiAgICAgIGZ1bmN0aW9uIHVwZGF0ZVByb2dyZXNzKGN1cnJlbnREZWx0YSkgewogICAgICAgIHZhciBvYmplY3QgPSB0aGlzOwogICAgICAgIHZhciBkZWx0YSA9IGN1cnJlbnREZWx0YSAtIHByZXZpb3VzRGVsdGE7CgogICAgICAgIGlmIChmcHNMaW1pdCAmJiBkZWx0YSA8IDEwMDAgLyBmcHNMaW1pdCkgey8vIFdhaXQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gSWYgc291bmQgbm9kZSBleGlzdHMgaW4gdGhpcyBtb21lbnQKICAgICAgICAgIGlmIChvYmplY3QuX3NvdW5kc1swXSkgewogICAgICAgICAgICBkYXRhLm1ldGhvZHNSZWZlcmVuY2UudXBkYXRlQ3VycmVudFRpbWUoYXBwRGF0YSwgb2JqZWN0KTsKCiAgICAgICAgICAgIGlmIChhcHBEYXRhLmVmZmVjdHMucG93ZXIgPT09IHRydWUpIHsKICAgICAgICAgICAgICAvLyBGcmVxdWVuY3kgYW5pbWF0ZQogICAgICAgICAgICAgIGlmIChtb2RlID09PSAxKSB7CiAgICAgICAgICAgICAgICBhbmFseXNlci5nZXRGbG9hdFRpbWVEb21haW5EYXRhKGRhdGFBcnJheSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlID09PSAyKSB7CiAgICAgICAgICAgICAgICBhbmFseXNlci5nZXRCeXRlVGltZURvbWFpbkRhdGEoZGF0YUFycmF5KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGdldExldmVscygpOwogICAgICAgICAgICAgIGRldGVjdExldmVsKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdkZWVwQmFzcycsCiAgICAgICAgICAgICAgICBtaW5MZXZlbDogMSwKICAgICAgICAgICAgICAgIG1heExldmVsOiA3LAogICAgICAgICAgICAgICAgdGhyZXNob2xkOiAtNSwKICAgICAgICAgICAgICAgIHJlbGVhc2U6IDI1MCwKICAgICAgICAgICAgICAgIGJhc3NTdGVwczogewogICAgICAgICAgICAgICAgICBwb3dlcjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgY291bnQ6IDYKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgaWYgKGl0ZW0uZWRpdGFibGUuZWZmZWN0cyAmJiBpdGVtLmVkaXRhYmxlLmVmZmVjdHMuaW5jbHVkZXMoJ3NjcmVlblNoYWtlJykpIHsKICAgICAgICAgICAgICAgIGRldGVjdExldmVsKHsKICAgICAgICAgICAgICAgICAgbmFtZTogJ3NjcmVlblNoYWtlJywKICAgICAgICAgICAgICAgICAgbWluTGV2ZWw6IDEsCiAgICAgICAgICAgICAgICAgIG1heExldmVsOiA3LAogICAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IC01LAogICAgICAgICAgICAgICAgICByZWxlYXNlOiAyNTAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZGV0ZWN0TGV2ZWwoewogICAgICAgICAgICAgICAgbmFtZTogJ21pZEJhc3MnLAogICAgICAgICAgICAgICAgbWluTGV2ZWw6IDUsCiAgICAgICAgICAgICAgICBtYXhMZXZlbDogMTAsCiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IC0xMCwKICAgICAgICAgICAgICAgIHJlbGVhc2U6IDI1MAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8qZGV0ZWN0TGV2ZWwoewogICAgICAgICAgICAgICAgICBuYW1lOiAndHJlYmxlJywKICAgICAgICAgICAgICAgICAgbW9kZTogJ2FueScsCiAgICAgICAgICAgICAgICAgIGFib3ZlTGV2ZWw6IDI1LAogICAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IC0xMCwKICAgICAgICAgICAgICAgICAgZXhjbHVkZUJlbG93OiAyMCwKICAgICAgICAgICAgICAgICAgZXhUaHJlc2hvbGQ6IC00MCwKICAgICAgICAgICAgICAgICAgcmVsZWFzZTogNTAKICAgICAgICAgICAgICB9KTsqLwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcHJldmlvdXNEZWx0YSA9IGN1cnJlbnREZWx0YTsKICAgICAgICB9CgogICAgICAgIGlmIChvYmplY3QucGxheWluZygpKSB7CiAgICAgICAgICBhcHBEYXRhLnNvdW5kT2JqZWN0UkFGID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZVByb2dyZXNzLmJpbmQob2JqZWN0KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2Vla1NvdW5kOiBmdW5jdGlvbiBzZWVrU291bmQoY3VySXRlbSwgc2Vjb25kcykgewogICAgICBjdXJJdGVtLnNvdW5kT2JqZWN0LnNlZWsoc2Vjb25kcyk7CiAgICB9LAogICAgc2V0VHJpbU1vZGU6IGZ1bmN0aW9uIHNldFRyaW1Nb2RlKGFwcERhdGEsIGl0ZW0sIGFjdGlvbikgewogICAgICB2YXIgY3VycmVudFRpbWUgPSBhcHBEYXRhLmN1cnJlbnRJdGVtLmN1cnJlbnRUaW1lOwogICAgICB2YXIgc3RhcnQgPSBpdGVtLnRyaW0gJiYgaXRlbS50cmltLnRpbWUuc3RhcnQgfHwgMDsKICAgICAgdmFyIGR1cmF0aW9uID0gaXRlbS50cmltICYmIGl0ZW0udHJpbS50aW1lLmR1cmF0aW9uIHx8IGl0ZW0uZHVyYXRpb247CiAgICAgIHZhciBlbmQgPSBzdGFydCArIGR1cmF0aW9uOwoKICAgICAgZnVuY3Rpb24gc2V0RW5kKCkgewogICAgICAgIHZhciBvZmZzZXQgPSBjdXJyZW50VGltZSAtIHN0YXJ0OwogICAgICAgIHZhciB0aW1lckR1cmF0aW9uID0gZHVyYXRpb24gLSBvZmZzZXQ7CiAgICAgICAgYXBwRGF0YS50cmltVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGFwcERhdGEuY3VycmVudEl0ZW0uc291bmRPYmplY3Quc2VlayhzdGFydCk7IC8vIFNlZWsgdG8gYmVnaW5uaW5nCiAgICAgICAgfSwgdGltZXJEdXJhdGlvbiAqIDEwMDApOwogICAgICB9CgogICAgICBmdW5jdGlvbiBib3VuZGFyeUdhdXJkKCkgewogICAgICAgIGlmIChjdXJyZW50VGltZSA8IHN0YXJ0IHx8IGN1cnJlbnRUaW1lID4gZW5kKSB7CiAgICAgICAgICBhcHBEYXRhLmN1cnJlbnRJdGVtLnNvdW5kT2JqZWN0LnNlZWsoc3RhcnQpOyAvLyBTZWVrIHRvIGJlZ2lubmluZwogICAgICAgIH0KICAgICAgfSAvLyBSZXNldAoKCiAgICAgIGlmIChhcHBEYXRhLnRyaW1UaW1lcikgewogICAgICAgIGNsZWFyVGltZW91dChhcHBEYXRhLnRyaW1UaW1lcik7IC8vIENhbmNlbCBwcmV2aW91cyB0cmltIHRpbWVyCiAgICAgIH0KCiAgICAgIGlmIChhY3Rpb24gPT09ICdwbGF5JyB8fCBhY3Rpb24gPT09ICdlbmQnKSB7CiAgICAgICAgYXBwRGF0YS5jdXJyZW50SXRlbS5zb3VuZE9iamVjdC5zZWVrKHN0YXJ0KTsgLy8gU2VlayB0byBiZWdpbm5pbmcKICAgICAgfQoKICAgICAgaWYgKGFjdGlvbiA9PT0gJ3BsYXknIHx8IGFjdGlvbiA9PT0gJ3NlZWsnKSB7CiAgICAgICAgYm91bmRhcnlHYXVyZCgpOwogICAgICAgIHNldEVuZCgpOwogICAgICB9CiAgICB9LAogICAgcmVzZXRDdXJyZW50U291bmQ6IGZ1bmN0aW9uIHJlc2V0Q3VycmVudFNvdW5kKGFwcERhdGEpIHsKICAgICAgdmFyIGN1cnJlbnRTb3VuZE9iamVjdCA9IF8uZ2V0KGFwcERhdGEsICdjdXJyZW50SXRlbS5zb3VuZE9iamVjdCcpOwoKICAgICAgaWYgKGN1cnJlbnRTb3VuZE9iamVjdCkgewogICAgICAgIGN1cnJlbnRTb3VuZE9iamVjdC51bmxvYWQoKTsKICAgICAgfSAvLyBVbmxvYWQgY3VycmVudCBzb3VuZAoKCiAgICAgIGFwcERhdGEuc291bmRPYmplY3RSQUYgPSAwOyAvLyBSZXNldCBhbmltYXRpb24gZnJhbWUKCiAgICAgIGZvciAodmFyIHByb3AgaW4gYXBwRGF0YS5jdXJyZW50SXRlbSkgewogICAgICAgIC8vIFJlc2V0IGN1cnJlbnQgc291bmQgcHJvcGVydGllcwogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYXBwRGF0YS5jdXJyZW50SXRlbSwgcHJvcCkpIHsKICAgICAgICAgIFZ1ZS5zZXQoYXBwRGF0YS5jdXJyZW50SXRlbSwgcHJvcCwgbnVsbCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/hervey/Projects/Development/audiomarketplace/src/mixins/AudioFunctions.js"],"names":["Vue","_","StayAwake","Howl","Howler","AudioFunctions","methods","trimNumber","num","decimals","number","s","toString","d","split","length","substring","parseFloat","join","playSound","appData","item","options","data","loadNew","methodsReference","timeData","start","trim","time","duration","merge","_id","currentItem","playMode","fileVersion","set","stop","loadSound","soundObject","playing","pause","play","updateCurrentTime","currentTime","seek","resetCurrentSound","src","volume","onplay","mode","setTrimMode","enable","soundObjectRAF","requestAnimationFrame","updateProgress","bind","onload","_duration","onend","disable","cancelAnimationFrame","nextIndex","mainItems","findIndex","onpause","onstop","onseek","editable","title","author","context","ctx","audioSourceNode","createBufferSource","analyser","createAnalyser","fftSize","bufferLength","frequencyBinCount","dataArray","Float32Array","Uint8Array","connect","masterGain","getLevels","levelsHertz","levelsPerc","sectionSplit","sections","finalArray","from","sec","minBin","maxBin","numOfBins","binItems","i","calcNum","hertz","Math","log10","perc","toFixed","push","levels","detectLevel","hertzTest","aboveLevel","anyAbove","levelIndex","threshold","excludeBelow","numOfLevels","maxLevel","minLevel","levelItems","includeHertz","excludeHertz","minExclude","numOfExLevels","maxExclude","exLevelItems","exLevelIndex","exThreshold","name","clearTimeout","setTimeout","release","bassSteps","current","newStep","count","previousDelta","fpsLimit","currentDelta","object","delta","_sounds","effects","power","getFloatTimeDomainData","getByteTimeDomainData","includes","seekSound","curItem","seconds","action","end","setEnd","offset","timerDuration","trimTimer","boundaryGaurd","currentSoundObject","get","unload","prop","Object","prototype","hasOwnProperty","call"],"mappings":"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","sourcesContent":["import Vue from 'vue';\nimport _ from 'lodash';\nimport StayAwake from 'stayawake.js';\nimport {Howl, Howler} from 'howler';\n\nexport const AudioFunctions = {\n\n    methods: {\n\n        // Move to general functions mixin\n        trimNumber: function(num, decimals) {\n            let number = num;\n            var s = num.toString();\n            var d = s.split(\".\");\n            if (d.length > 1) {\n                d[1] = d[1].substring(0, decimals);\n                number = parseFloat(d.join(\".\"));\n            }\n            return number;\n        },\n\n        // Keep here\n\n        playSound(appData, item, options = {}) {\n            var data = {\n                loadNew: true,\n                methodsReference: this,\n                timeData: {\n                    start: item.trim && item.trim.time ? item.trim.time.start: 0,\n                    duration: item.trim && item.trim.time ? item.trim.time.duration: item.duration\n                }\n            }\n            _.merge(data, options);\n            if (item._id === appData.currentItem._id) { // Loaded sound is the same      \n                \n                // Trim mode\n                if (data.playMode === 'trim') {                    \n                    if (appData.currentItem.fileVersion === 'full') { // Should be full file version                                                 \n                        data.loadNew = false;\n                    }\n                } \n\n                // Default mode\n                else {\n                    data.loadNew = false;\n                }\n            }            \n            \n            // Trim mode\n            if (data.playMode === 'trim') {\n                _.set(item, 'trim.time', data.timeData);\n            }\n\n            // Load new sound\n            if (data.loadNew === true) {\n                Howler.stop();\n                Vue.set(item, 'status', 'initial');\n                Vue.set(appData.currentItem, 'status', 'loading');\n                data.methodsReference.loadSound(appData, item, data);\n            } else {\n                // Already playing                \n                if (appData.currentItem.soundObject.playing()) {\n                    appData.currentItem.soundObject.pause();\n                    \n                    if (data.playMode === 'trim') {                        \n                        appData.currentItem.soundObject.play();\n                    }\n                } else {\n                    appData.currentItem.soundObject.play();                    \n                }\n            }                \n        },\n        updateCurrentTime(appData, soundObject) {\n            var currentTime = soundObject.seek() || 0;\n            Vue.set(appData.currentItem, 'currentTime', currentTime);\n        },\n        loadSound(appData, item, options) {\n            var data = {\n                methodsReference: this               \n            };\n            if (options) {\n                _.merge(data, options);\n            } \n\n            data.methodsReference.resetCurrentSound(appData); // Reset current sound\n            data.fileVersion = data.playMode === 'trim' ? 'full': 'preview'; // Set file version\n    \n            // Change state for audio player or parent\n            // Highlight clip time in main player\n                                \n            // Create sound object\n            Vue.set(appData.currentItem, 'soundObject', new Howl({\n                src: './database/audio/'+ item._id +'/'+ data.fileVersion +'.mp3',\n                volume: 1,\n                \n\n                // Events\n                onplay: function(){\n                    data.methodsReference.updateCurrentTime(appData,appData.currentItem.soundObject);\n\n                    // Trim mode settings\n                    if (item.mode === 'edit') {\n                        data.methodsReference.setTrimMode(appData, item, 'play');    \n                    }                 \n\n                    StayAwake.enable();                                         \n                    appData.soundObjectRAF = requestAnimationFrame(updateProgress.bind(appData.currentItem.soundObject));\n                    Vue.set(item, 'status', 'playing');\n                    Vue.set(appData.currentItem, 'status', 'playing');\n                },\n                onload: function() {\n                    Vue.set(appData.currentItem, 'duration', appData.currentItem.soundObject._duration);                    \n                    appData.currentItem.soundObject.play();\n                },\n                onend: function() {\n\n                    StayAwake.disable();\n                    \n                    cancelAnimationFrame(appData.soundObjectRAF);\n                    Vue.set(item, 'status', 'initial');\n                    Vue.set(appData.currentItem, 'status', 'initial');\n\n                    // Play next\n                    if (!data.playMode || data.playMode === 'mainFeed') {\n                        var nextIndex = appData.mainItems.findIndex(item => item._id === appData.currentItem._id)+1;\n                        if (nextIndex === appData.mainItems.length) {\n                            nextIndex = 0;\n                        }\n                        data.methodsReference.playSound(appData, appData.mainItems[nextIndex]);\n                    } \n                    else if (data.playMode === 'trim') { // Trim mode\n                    }\n                },\n                onpause: function() {\n\n                    // Trim mode settings\n\n                    StayAwake.disable();\n                    \n                    cancelAnimationFrame(appData.soundObjectRAF);\n                    Vue.set(item, 'status', 'paused');\n                    Vue.set(appData.currentItem, 'status', 'paused');\n                },\n                onstop: function() {\n\n                    // Trim mode settings\n                    if (item.mode === 'edit') {\n                        data.methodsReference.setTrimMode(appData, item, 'stop');\n                    }\n\n                    StayAwake.disable();\n                    \n                    cancelAnimationFrame(appData.soundObjectRAF);\n                    Vue.set(item, 'status', 'paused');\n                    Vue.set(appData.currentItem, 'status', 'initial');\n                },\n                onseek: function() {\n                    data.methodsReference.updateCurrentTime(appData,appData.currentItem.soundObject);\n\n                    // Trim mode settings\n                    if (item.mode === 'edit') {\n                        data.methodsReference.setTrimMode(appData, item, 'seek');\n                    }\n                    appData.soundObjectRAF = requestAnimationFrame(updateProgress.bind(appData.currentItem.soundObject));\n                }\n            })\n            );\n\n            // Update current object\n            Vue.set(appData.currentItem, '_id', item._id);\n            Vue.set(appData.currentItem, 'title', item.editable.title);\n            Vue.set(appData.currentItem, 'author', item.editable.author);\n            Vue.set(appData.currentItem, 'fileVersion', data.fileVersion);\n\n            // Effects\n                // Create an analyser node in the Howler WebAudio context\n                var context = Howler.ctx;\n                const audioSourceNode = context.createBufferSource(appData.currentItem.soundObject);\n                var analyser = context.createAnalyser();\n                analyser.fftSize = 1024;\n                const bufferLength = analyser.frequencyBinCount;\n\n                var dataArray;\n                var mode = 2;\n                if (mode === 1) {\n                    dataArray = new Float32Array(analyser.fftSize);\n                } else {\n                    dataArray = new Uint8Array(analyser.fftSize);\n                }\n\n                audioSourceNode.connect(analyser);\n                Howler.masterGain.connect(analyser);\n\n                function getLevels(){\n                    var levelsHertz = [];\n                    var levelsPerc = [];\n                    var sectionSplit = 16;\n                    var sections = bufferLength/sectionSplit;\n                    if (mode === 1 || mode===2) {\n                        var finalArray = dataArray;\n                        if (mode===2) {\n                            finalArray = Float32Array.from(dataArray)\n                        }\n\n                        for (let sec = 0; sec < sections; sec++) {\n                            const minBin = (sec*sectionSplit);\n                            const maxBin = ((sec+1)*sectionSplit);\n                            const numOfBins = maxBin - minBin;\n                            let binItems = 0;\n                            for (let i = minBin; i < maxBin; i++) {\n                                var calcNum = finalArray[i];\n                                if (mode === 2) {\n                                    calcNum = (calcNum - 128) / 128;\n                                }\n\n                                binItems += calcNum ** 2;\n                            }\n                            const hertz = 10 * Math.log10(binItems / numOfBins);\n                            const perc = (100 + (hertz)).toFixed();\n                            levelsHertz.push(hertz);\n                            levelsPerc.push(perc);\n                        }\n                    }\n                    \n                    // Update levels\n                    var levels = {\n                        'hertz':levelsHertz,\n                        'perc': levelsPerc\n                    }\n                    Vue.set(appData.currentItem, 'levels', levels);\n                    return levels;\n                }\n                function detectLevel(options) {\n                    var hertzTest = true;\n                    var levels = getLevels();\n                    \n                    if (options.mode === 'any') {\n                        if (options.aboveLevel) {\n                            var anyAbove = false;\n                            for (let levelIndex = options.aboveLevel; levelIndex < levels.hertz.length; levelIndex++) {\n                                if (levels.hertz[levelIndex] > (options.threshold)) { anyAbove = true }\n                            }\n                            if (options.excludeBelow) {\n                                for (let levelIndex = 0; levelIndex < options.excludeBelow; levelIndex++) {\n                                    if (levels.hertz[levelIndex] > (options.threshold)) { \n                                        anyAbove = false \n                                    }\n                                }\n                            }\n                            if (anyAbove === false) {\n                                hertzTest = false;\n                            }\n                        }\n                    }\n                    else {\n                        var numOfLevels = options.maxLevel - options.minLevel;\n                        var levelItems = 0;\n                        for (let levelIndex = options.minLevel; levelIndex < options.maxLevel; levelIndex++) {\n                            levelItems += levels.hertz[levelIndex];\n                        }\n                        const includeHertz = (levelItems / numOfLevels);\n                        var excludeHertz;\n                        if (options.minExclude) {\n                            var numOfExLevels = options.maxExclude - options.minExclude;\n                            var exLevelItems = 0; \n                            for (let exLevelIndex = options.minExclude; exLevelIndex < options.maxExclude; exLevelIndex++) {\n                                exLevelItems += levels.hertz[exLevelIndex];\n                            }\n                            excludeHertz = (exLevelItems / numOfExLevels);\n                        }\n\n                        if (includeHertz < (options.threshold)) { hertzTest = false }\n                        if (excludeHertz && excludeHertz > (options.exThreshold)) {hertzTest = false}\n                    }\n                    if (hertzTest === true) {\n                        Vue.set(appData.currentItem, options.name, true);\n                        if (appData.currentItem[options.name+'Timer']) {\n                            clearTimeout(appData.currentItem[options.name+'Timer']);\n                        }\n                        Vue.set(appData.currentItem, options.name+'Timer', setTimeout(function(){ \n                            Vue.set(appData.currentItem, options.name, false);\n                            Vue.set(appData.currentItem, options.name+'Timer', \"\");\n                        }, options.release));\n\n                        // Bass steps\n                        if (options.bassSteps) {\n                            if (appData.currentItem.bassSteps && appData.currentItem.bassSteps.current !== false) {\n                                if (appData.currentItem.bassSteps['trigger'] === true) {\n                                    Vue.set(appData.currentItem.bassSteps,'trigger', false); // Trigger off\n\n                                    // Next step\n                                    var newStep = appData.currentItem.bassSteps.current + 1 > options.bassSteps.count ? 0:\n                                    appData.currentItem.bassSteps.current + 1;\n                                    Vue.set(appData.currentItem.bassSteps,'current', newStep);\n                                    \n                                    // Trigger timer\n                                    Vue.set(appData.currentItem.bassSteps, 'timer', setTimeout(function(){\n                                        Vue.set(appData.currentItem.bassSteps,'trigger', true); // Trigger on\n                                    }, '100'));\n                                }\n                            } else {\n                                Vue.set(appData.currentItem,'bassSteps.trigger', false); // Trigger off\n                                Vue.set(appData.currentItem, 'bassSteps', {'current':0}); // Initial step\n                                \n                                // Trigger timer\n                                Vue.set(appData.currentItem.bassSteps, 'timer', setTimeout(function(){\n                                    Vue.set(appData.currentItem.bassSteps,'trigger', true); // Trigger on\n                                }, '87.5'));\n                            }\n                        }\n                    }\n                }\n                var previousDelta = 0,\n                fpsLimit = 60;\n                function updateProgress(currentDelta) {\n                    var object = this;\n                        var delta = currentDelta - previousDelta;\n                        if (fpsLimit && delta < 1000 / fpsLimit) {\n                            // Wait\n                        } else {\n                            // If sound node exists in this moment\n                            if (object._sounds[0]) {\n                                data.methodsReference.updateCurrentTime(appData,object);\n\n                                if (appData.effects.power === true) {\n                                    // Frequency animate\n                                    if (mode === 1) {\n                                        analyser.getFloatTimeDomainData(dataArray)\n                                    } else if (mode === 2) {\n                                        analyser.getByteTimeDomainData(dataArray);\n                                    }\n                                        getLevels();\n                                        detectLevel({\n                                            name: 'deepBass',\n                                            minLevel: 1,\n                                            maxLevel: 7,\n                                            threshold: -5,\n                                            release: 250,\n                                            bassSteps: {\n                                                power: true,\n                                                count: 6\n                                            } \n                                        });\n                                        if (item.editable.effects && item.editable.effects.includes('screenShake')) {\n                                            detectLevel({\n                                                name: 'screenShake',\n                                                minLevel: 1,\n                                                maxLevel: 7,\n                                                threshold: -5,\n                                                release: 250\n                                            });\n                                        }\n                                        detectLevel({\n                                            name: 'midBass',\n                                            minLevel: 5,\n                                            maxLevel: 10,\n                                            threshold: -10,\n                                            release: 250\n                                        });\n                                        /*detectLevel({\n                                            name: 'treble',\n                                            mode: 'any',\n                                            aboveLevel: 25,\n                                            threshold: -10,\n                                            excludeBelow: 20,\n                                            exThreshold: -40,\n                                            release: 50\n                                        });*/\n                                }\n                            }\n                            previousDelta = currentDelta;\n                        }\n                    if (object.playing()) {\n                        appData.soundObjectRAF = requestAnimationFrame(updateProgress.bind(object));\n                    }\n                }\n        },\n        seekSound(curItem,seconds) {\n            curItem.soundObject.seek(seconds);\n        },\n        setTrimMode(appData, item, action) {\n            var currentTime = appData.currentItem.currentTime;\n            var start = item.trim && item.trim.time.start || 0;\n            var duration = item.trim && item.trim.time.duration || item.duration;\n            var end = start + duration;\n\n            function setEnd() {\n                var offset = currentTime - start;\n                var timerDuration = duration - offset; \n                appData.trimTimer = setTimeout(function(){\n                    appData.currentItem.soundObject.seek(start); // Seek to beginning\n                }, timerDuration * 1000);\n            }\n                \n            function boundaryGaurd() {\n                if (currentTime < start || currentTime > end) {\n                    appData.currentItem.soundObject.seek(start); // Seek to beginning\n                }\n            }\n\n            // Reset\n            if (appData.trimTimer) {\n                clearTimeout(appData.trimTimer); // Cancel previous trim timer\n            }\n\n            if (action === 'play' || action === 'end') {\n                appData.currentItem.soundObject.seek(start); // Seek to beginning\n            }\n\n            if (action === 'play' || action === 'seek') {\n                boundaryGaurd();\n                setEnd();\n            }\n        },\n        resetCurrentSound(appData) {\n            var currentSoundObject = _.get(appData,'currentItem.soundObject');\n            if (currentSoundObject) { currentSoundObject.unload(); } // Unload current sound\n            appData.soundObjectRAF = 0; // Reset animation frame\n            for (var prop in appData.currentItem) { // Reset current sound properties\n                if (Object.prototype.hasOwnProperty.call(appData.currentItem, prop)) {\n                    Vue.set(appData.currentItem, prop, null);\n                }\n            }\n        }\n    }\n}"]}]}