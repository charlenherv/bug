{"remainingRequest":"/Users/hervey/bug/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hervey/bug/client/src/components/pages/Game.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hervey/bug/client/src/components/pages/Game.vue","mtime":1638392784985},{"path":"/Users/hervey/bug/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/hervey/bug/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hervey/bug/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAidnVlIjsKaW1wb3J0IFBoYXNlciBmcm9tICJwaGFzZXIiOwppbXBvcnQgeyBBdWRpb0Z1bmN0aW9ucyB9IGZyb20gIi4uLy4uL21peGlucy9BdWRpb0Z1bmN0aW9ucy5qcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkdhbWUiLAogIG1peGluczogW0F1ZGlvRnVuY3Rpb25zXSwKICBjb21wdXRlZDogewogICAgaGlnaFNjb3JlKCkgewogICAgICBjb25zdCBnb3RBSGlnaFNjb3JlID0gZmFsc2U7CiAgICAgIHJldHVybiBnb3RBSGlnaFNjb3JlOwogICAgfSwKICAgIHNoaXBBbGl2ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMubGlmZSA+IDA7CiAgICB9LAogICAgbGlmZUxldmVsKCkgewogICAgICBjb25zdCBsZXZlbCA9IAogICAgICAgIHRoaXMubGlmZSA+PSA3NSA/ICdoaWdoJzoKICAgICAgICB0aGlzLmxpZmUgPj0gNTAgPyAnbWVkJzoKICAgICAgICAnbG93JzsKICAgICAgcmV0dXJuIGxldmVsOwogICAgfSwKICAgIHRvdGFsU2NvcmUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS50b3RhbFNjb3JlOwogICAgfSwKICAgIGdhbWVNZXNzYWdlKCkgewogICAgICBjb25zdCBtZXNzYWdlID0KICAgICAgICB0aGlzLmdhbWVTdGF0dXMgPT09ICJwYXVzZWQiCiAgICAgICAgICA/ICJwYXVzZWQiCiAgICAgICAgICA6IHRoaXMuZ2FtZVN0YXR1cyA9PT0gImVycm9yIgogICAgICAgICAgPyAiZXJyb3IgLSByZWZyZXNoIHRvIHN0YXJ0IG92ZXIiCiAgICAgICAgICA6IHRoaXMuZ2FtZVN0YXR1cyA9PT0gIm92ZXIiCiAgICAgICAgICA/ICJ5b3UgZGVhZCIKICAgICAgICAgIDogdGhpcy5nYW1lU3RhdHVzID09PSAiY29tcGxldGUiICYmIHRoaXMuaGlnaFNjb3JlCiAgICAgICAgICA/ICJoaWdoIHNjb3JlIgogICAgICAgICAgOiB0aGlzLmdhbWVTdGF0dXMgPT09ICdjb21wbGV0ZScgPwogICAgICAgICAgICAibW9yZSBjb21pbmcgc29vbiIKICAgICAgICAgIDogZmFsc2U7CiAgICAgIHJldHVybiBtZXNzYWdlOwogICAgfSwKICAgIGxlYWRlckJvYXJkRW50cmllcygpIHsKICAgICAgY29uc3QgZW50cmllcyA9IHRoaXMuJHN0b3JlLnN0YXRlLmxlYWRlckJvYXJkRW50cmllczsKICAgICAgcmV0dXJuIGVudHJpZXM7CiAgICB9LAogICAgZ2FtZUJhY2tncm91bmQoKSB7CiAgICAgIGNvbnN0IGNvbG9yID0KICAgICAgICB0aGlzLmdhbWVTdGF0dXMgPT09ICJvdmVyIgogICAgICAgICAgPyAiYnVyZ3VuZHkiCiAgICAgICAgOiB0aGlzLmdhbWVTdGF0dXMgPT09ICJjb21wbGV0ZSIKICAgICAgICAgID8gIm5hdnkiCiAgICAgICAgICA6IHRoaXMuY3VycmVudExldmVsLmJhY2tncm91bmQKICAgICAgICAgID8gdGhpcy5jdXJyZW50TGV2ZWwuYmFja2dyb3VuZAogICAgICAgICAgOiAibmF2eSI7CiAgICAgIHJldHVybiBjb2xvcjsKICAgIH0sCiAgICBjdXJyZW50QXVkaW9TdGVwKCkgewogICAgICByZXR1cm4gdGhpcy5hdWRpby5iYXNzU3RlcHMuY3VycmVudCB8fCAxOwogICAgfSwKICAgIHNoYWtlU2NyZWVuTm93ICgpIHsKICAgICAgcmV0dXJuIHRoaXMuYXVkaW8uY3JhenlCYXNzID09PSB0cnVlCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VycmVudFBhZ2U6ICJkYXNoYm9hcmQiLAogICAgICBnYW1lSW5pdGlhbGl6YXRpb246IGZhbHNlLAogICAgICBnYW1lQ29uZmlnOiB7fSwKICAgICAgZ2FtZVN0YXR1czogImxvYWRpbmciLAogICAgICBnYW1lQXR0ZW1wdHM6IFtdLAogICAgICBsaWZlOiAxMDAsCiAgICAgIGxpdmVzOiAzLAoKICAgICAgYXVkaW86IHsKICAgICAgICBiYXNzU3RlcHM6IHsKICAgICAgICAgIGN1cnJlbnQ6IDAsCiAgICAgICAgICBjb3VudDogMCwKICAgICAgICB9LAogICAgICAgIGxldmVsczoge30KICAgICAgfSwKICAgICAgbGV2ZWxzOiBbCiAgICAgICAgewogICAgICAgICAgX2lkOiAxLAogICAgICAgICAgZmlsZW5hbWU6ICIxIiwKICAgICAgICAgIGJhY2tncm91bmQ6ICJuYXZ5IiwKICAgICAgICAgIGdyYXZpdHk6NTAKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIF9pZDogMiwKICAgICAgICAgIGZpbGVuYW1lOiAiMiIsCiAgICAgICAgICBiYWNrZ3JvdW5kOiAicHVycGxlIiwKICAgICAgICAgIGdyYXZpdHk6MTAwCiAgICAgICAgfSwKCiAgICAgICAgewogICAgICAgICAgX2lkOiAzLAogICAgICAgICAgZmlsZW5hbWU6ICIzIiwKICAgICAgICAgIGJhY2tncm91bmQ6ICJqYXp6IiwKICAgICAgICAgIGdyYXZpdHk6MjUwLAogICAgICAgICAgc2hha2VTY3JlZW46IHRydWUKICAgICAgICB9LAoKICAgICAgICB7CiAgICAgICAgICBfaWQ6IDQsCiAgICAgICAgICBmaWxlbmFtZTogIjQiLAogICAgICAgICAgYmFja2dyb3VuZDogImJsYWNrIiwKICAgICAgICAgIGdyYXZpdHk6MTAwCiAgICAgICAgfSwKCiAgICAgICAgewogICAgICAgICAgX2lkOiA1LAogICAgICAgICAgZmlsZW5hbWU6ICI1IiwKICAgICAgICAgIGJhY2tncm91bmQ6ICJzdGVwcyIsCiAgICAgICAgICBncmF2aXR5OjIwMAogICAgICAgIH0sCiAgICAgICAgLyoKICAgICAgICB7CiAgICAgICAgICBfaWQ6IDYsCiAgICAgICAgICBmaWxlbmFtZTogInRlc3QiLAogICAgICAgICAgYmFja2dyb3VuZDogInN0ZXBzIiwKICAgICAgICAgIGdyYXZpdHk6MTAwMAogICAgICAgIH0qLwogICAgICBdLAogICAgICAKCiAgICAgIGN1cnJlbnRMZXZlbDoge30sCiAgICAgIGN1cnJlbnREZWF0aE9iamVjdHM6IFtdLAogICAgICBjdXJyZW50UG9pbnRTdGFyczogW10sCiAgICAgIGJ1bGxldFNwZWVkOiA3NTAsCiAgICAgIGdvb2RPYmplY3RzOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogInBvaW50LXN0YXIiLAogICAgICAgICAgd2lkdGg6IDIzLAogICAgICAgICAgaGVpZ2h0OiA0NiAvIDIsCiAgICAgICAgICBwb2ludHM6IDUsCiAgICAgICAgICBwcm9iOiAxCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgZGVhdGhPYmplY3RzOiBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogInNwaXJhbCIsCiAgICAgICAgICB3aWR0aDogNDcsCiAgICAgICAgICBoZWlnaHQ6IDQ1LAogICAgICAgICAgcHJvYjogMC4wMjUKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJjb21ldCIsCiAgICAgICAgICB3aWR0aDogNDIsCiAgICAgICAgICBoZWlnaHQ6IDg2IC8gMiwKICAgICAgICAgIHBvaW50czogNTAwLAogICAgICAgICAgcHJvYjogMC4zCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAic3Ryb2lkIiwKICAgICAgICAgIHdpZHRoOiA0MiwKICAgICAgICAgIGhlaWdodDogODAgLyAyLAogICAgICAgICAgcG9pbnRzOiAyNTAsCiAgICAgICAgICBwcm9iOiAwLjUKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICJzdGFyIiwKICAgICAgICAgIHdpZHRoOiAyMywKICAgICAgICAgIGhlaWdodDogNDYgLyAyLAogICAgICAgICAgcG9pbnRzOiAxMDAsCiAgICAgICAgICBwcm9iOiAxCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgeDogd2luZG93LmlubmVyV2lkdGggLyAyLAogICAgICB5OiB3aW5kb3cuaW5uZXJIZWlnaHQgLSA1MCwKICAgICAgdXBkYXRlVGltZTogNTAsCiAgICAgIHVwZGF0ZVRpbWVyOiAwLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJhbmRvbUl0ZW1Qcm9iYWJsaXR5KG9wdGlvbnMpIHsKICAgICAgY29uc3Qgd2VpZ2h0ZWRPcHRpb25zID0gb3B0aW9ucy5zb3J0KCh7cHJvYjphfSwge3Byb2I6Yn0pID0+IGEgLSBiKTsKICAgICAgY29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC5yYW5kb20oKTsKICAgICAgbGV0IG9iajsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3ZWlnaHRlZE9wdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBwcmV2V2VpZ2h0ID0gaSA+IDAgPyB3ZWlnaHRlZE9wdGlvbnNbaSAtIDFdLnByb2I6IDA7CiAgICAgICAgaWYgKAogICAgICAgICAgcmFuZG9tTnVtYmVyID4gcHJldldlaWdodCAmJiByYW5kb21OdW1iZXIgPD0gd2VpZ2h0ZWRPcHRpb25zW2ldLnByb2IKICAgICAgICApIHsKICAgICAgICAgIG9iaiA9IG9wdGlvbnNbaV0gCiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajsKICAgIH0sCiAgICByYW5kb21OdW1iZXIobWluLCBtYXgpIHsKICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pbjsKICAgIH0sCiAgICBzeXN0ZW1Tb3VuZChrZXkpIHsKICAgICAgY29uc3Qgc291bmQgPSB0aGlzLiRyZWZzLnNvdW5kUGxheWVyOwogICAgICBzb3VuZC5zcmMgPSAnYXVkaW8vZWZmZWN0cy8nK2tleSsnLm1wMyc7CiAgICAgIHNvdW5kLnBsYXkoKTsKICAgIH0sCiAgICBjaGFuZ2VQYWdlKHBhZ2UpIHsKICAgICAgY29uc3QgY29tcG9uZW50Q29udGV4dCA9IHRoaXM7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBwYWdlOwogICAgICBjb21wb25lbnRDb250ZXh0LnN5c3RlbVNvdW5kKCdidXR0b24tc2VsZWN0Jyk7CgogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lU3RhdHVzID09PSAic3RhcnRlZCIgfHwKICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZVN0YXR1cyA9PT0gIm92ZXIiIHx8IAogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lU3RhdHVzID09PSAiY29tcGxldGUiCiAgICAgICAgKSB7CiAgICAgICAgICBpZiAocGFnZSAhPT0gImdhbWUiKSB7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBSZXN0YXJ0IGdhbWUKICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5pbml0aWFsaXplR2FtZSgpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBGaXJzdCBnYW1lCiAgICAgICAgICBpZiAocGFnZSA9PT0gImdhbWUiKSB7CiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuaW5pdGlhbGl6ZUdhbWUoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICByZW1vdmVBbGxPYmplY3RzKCkgewogICAgICBjb25zdCBjb21wb25lbnRDb250ZXh0ID0gdGhpczsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmN1cnJlbnREZWF0aE9iamVjdHMuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgICBvYmoub2JqZWN0LnNldEFjdGl2ZShmYWxzZSkuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgICBvYmoub2JqZWN0LmRlc3Ryb3koKTsKICAgICAgICB9KTsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmN1cnJlbnREZWF0aE9iamVjdHMgPSBbXTsKCiAgICAgICAgY29tcG9uZW50Q29udGV4dC5jdXJyZW50UG9pbnRTdGFycy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHsKICAgICAgICAgIG9iai5vYmplY3Quc2V0QWN0aXZlKGZhbHNlKS5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICAgIG9iai5vYmplY3QuZGVzdHJveSgpOwogICAgICAgIH0pOwogICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudFBvaW50U3RhcnMgPSBbXTsKICAgIH0sCiAgICBpbml0aWFsaXplR2FtZShhZ2FpbikgewogICAgICBjb25zdCBjb21wb25lbnRDb250ZXh0ID0gdGhpczsKCiAgICAgIGlmIChhZ2FpbikgewogICAgICAgIGNvbXBvbmVudENvbnRleHQuc3lzdGVtU291bmQoJ2J1dHRvbi1zZWxlY3QnKTsKICAgICAgfQoKICAgICAgaWYgKGNvbXBvbmVudENvbnRleHQuZGVzdHJveUdhbWUpIHsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmRlc3Ryb3lHYW1lLmZ1bmMoKTsKICAgICAgfQogICAgICB0aGlzLmdhbWVTdGF0dXMgPSAibG9hZGluZyI7CiAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudExldmVsID0gY29tcG9uZW50Q29udGV4dC5sZXZlbHNbMF07CiAgICAgIGNvbXBvbmVudENvbnRleHQudXBkYXRlU2NvcmUoInJlc2V0Iik7CiAgICAgIGNvbXBvbmVudENvbnRleHQubGl2ZXMgPSAzOwogICAgICBjb21wb25lbnRDb250ZXh0LmxpZmUgPSAxMDA7CgogICAgICBjb21wb25lbnRDb250ZXh0LnBoYXNlckdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoCiAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29uZmlnCiAgICAgICk7CiAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUluaXRpYWxpemF0aW9uID0gdHJ1ZTsKICAgIH0sCiAgICBlbmRHYW1lKCkgewogICAgICBjb25zdCBjb21wb25lbnRDb250ZXh0ID0gdGhpczsKICAgICAgY29tcG9uZW50Q29udGV4dC5yZW1vdmVBbGxPYmplY3RzKCk7CiAgICAgIGNvbXBvbmVudENvbnRleHQuc3RvcFNvdW5kKGNvbXBvbmVudENvbnRleHQpOwogICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVTdGF0dXMgPSAiY29tcGxldGUiOwogICAgICAKICAgICAgLy8gQWRkIHNjb3JlCiAgICAgIC8vIENoZWNrIGhpZ2ggc2NvcmUKICAgIH0sCiAgICB1cGRhdGVTY29yZShwb2ludHMpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInVwZGF0ZVNjb3JlIiwgcG9pbnRzKTsKICAgIH0sCiAgICBhbmltYXRlU2hpcChnYW1lQ29udGV4dCwgYW5pbWF0aW9uLCBvdmVycmlkZSA9IGZhbHNlKSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudENvbnRleHQgPSB0aGlzOwogICAgICBjb25zdCBhbmltYXRpb25SZWFkeSA9CiAgICAgICAgb3ZlcnJpZGUgPT09IHRydWUKICAgICAgICAgID8gdHJ1ZQogICAgICAgICAgOiBjb21wb25lbnRDb250ZXh0LnNoaXBBbGl2ZSAmJiBnYW1lQ29udGV4dC52dWxuZXJhYmxlCiAgICAgICAgICA/IHRydWUKICAgICAgICAgIDogYW5pbWF0aW9uID09PSAiZGVhdGgiCiAgICAgICAgICA/IHRydWUKICAgICAgICAgIDogZmFsc2U7CiAgICAgIGlmIChhbmltYXRpb25SZWFkeSkgewogICAgICAgIGdhbWVDb250ZXh0LnNoaXAucGxheShhbmltYXRpb24pOwogICAgICB9CiAgICB9LAogICAgc2hpcEZsb2F0KGdhbWVDb250ZXh0KSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudENvbnRleHQgPSB0aGlzOwogICAgICBpZiAoY29tcG9uZW50Q29udGV4dC5zaGlwQWxpdmUpIHsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmFuaW1hdGVTaGlwKGdhbWVDb250ZXh0LCAiZmxvYXQiKTsKICAgICAgfQogICAgfSwKICAgIGRlc3Ryb3lQb2ludFN0YXIoaWQpIHsKICAgICAgY29uc3QgY29tcG9uZW50Q29udGV4dCA9IHRoaXM7CiAgICAgIGNvbnN0IG9iaiA9IGNvbXBvbmVudENvbnRleHQuY3VycmVudFBvaW50U3RhcnMuZmlsdGVyKHBvaW50U3RhciA9PiBwb2ludFN0YXIuaWQgPT09IGlkKTsKICAgICAgY29uc3QgaW5kZXggPSBjb21wb25lbnRDb250ZXh0LmN1cnJlbnRQb2ludFN0YXJzLmZpbmRJbmRleCgKICAgICAgICAocG9pbnRTdGFyKSA9PiBwb2ludFN0YXIuaWQgPT09IGlkCiAgICAgICk7CiAgICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgICAgb2JqWzBdLm9iamVjdC5zZXRBY3RpdmUoZmFsc2UpOwogICAgICAgIG9ialswXS5vYmplY3Quc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgb2JqWzBdLm9iamVjdC5kZXN0cm95KCk7CgogICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudFBvaW50U3RhcnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgICB9LAogICAgZGVzdHJveU9iamVjdChvYmopIHsKICAgICAgY29uc3QgY29tcG9uZW50Q29udGV4dCA9IHRoaXM7CiAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc291bmRzLmRlc3Ryb3lbb2JqLm5hbWVdLnBsYXkoKTsKCiAgICAgIGlmIChvYmoubmFtZSA9PT0gInN0cm9pZCIpIHsKICAgICAgICBvYmoub2JqZWN0LmNsZWFyVGludCgpOwogICAgICB9CiAgICAgIG9iai5vYmplY3QucGxheSgiZGVzdHJveS0iICsgb2JqLm5hbWUpOwogICAgICBvYmoub2JqZWN0Lm5vdEFUaHJlYXQgPSB0cnVlOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBjb21wb25lbnRDb250ZXh0LnJlbW92ZU9iamVjdChvYmopOwogICAgICB9LCA1MDApOwogICAgfSwKICAgIHJlbW92ZU9iamVjdChvYmopIHsKICAgICAgY29uc3QgY29tcG9uZW50Q29udGV4dCA9IHRoaXM7CiAgICAgIGNvbnN0IGluZGV4ID0gY29tcG9uZW50Q29udGV4dC5jdXJyZW50RGVhdGhPYmplY3RzLmZpbmRJbmRleCgKICAgICAgICAoZGVhdGhPYmplY3QpID0+IGRlYXRoT2JqZWN0LmlkID09PSBvYmouaWQKICAgICAgKTsKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICBvYmoub2JqZWN0LnNldEFjdGl2ZShmYWxzZSk7CiAgICAgICAgb2JqLm9iamVjdC5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICBvYmoub2JqZWN0LmRlc3Ryb3koKTsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmN1cnJlbnREZWF0aE9iamVjdHMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgfSwKICAgIHNoaXBMaWZlKGdhbWVDb250ZXh0LCBhbW91bnQsIG9iamVjdE5hbWUpIHsKICAgICAgY29uc3QgY29tcG9uZW50Q29udGV4dCA9IHRoaXM7CiAgICAgIGZ1bmN0aW9uIHJlc2V0VnVsbmVyYWJpbGl0eSgpIHsKICAgICAgICBjbGVhclRpbWVvdXQoZ2FtZUNvbnRleHQudnVsbmVyYWJpbGl0eVRpbWVyKTsKICAgICAgICBnYW1lQ29udGV4dC52dWxuZXJhYmxlID0gZmFsc2U7CiAgICAgICAgZ2FtZUNvbnRleHQudnVsbmVyYWJpbGl0eVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBnYW1lQ29udGV4dC52dWxuZXJhYmxlID0gdHJ1ZTsKICAgICAgICB9LCAxNTAwKTsKICAgICAgfQogICAgICBmdW5jdGlvbiBsaWZlQ2hlY2soKSB7CiAgICAgICAgY29tcG9uZW50Q29udGV4dC5saXZlcyAtPSAxOwogICAgICAgIGlmIChjb21wb25lbnRDb250ZXh0LmxpdmVzIDwgMSkgewogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lU3RhdHVzID0gIm92ZXIiOwogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5zdG9wU291bmQoY29tcG9uZW50Q29udGV4dCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuYWRkU2hpcChnYW1lQ29udGV4dCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIAogICAgICBpZiAoYW1vdW50ID09PSAicmVzdG9yZSIpIHsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmxpZmUgPSAxMDA7CiAgICAgICAgY29tcG9uZW50Q29udGV4dC5hbmltYXRlU2hpcChnYW1lQ29udGV4dCwgInJlc3RvcmUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoZ2FtZUNvbnRleHQudnVsbmVyYWJsZSkgewogICAgICAgICAgaWYgKGFtb3VudCAhPT0gImRlYXRoIikgewogICAgICAgICAgICAvLyBUYWtlIGRhbWFnZQogICAgICAgICAgICBpZiAoYW1vdW50IDwgMCkgewogICAgICAgICAgICAgIGlmIChvYmplY3ROYW1lICYmIGdhbWVDb250ZXh0LnNvdW5kcy5kYW1hZ2Vbb2JqZWN0TmFtZV0pIHsKICAgICAgICAgICAgICAgIGdhbWVDb250ZXh0LnNvdW5kcy5kYW1hZ2Vbb2JqZWN0TmFtZV0ucGxheSgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5saWZlIC09IGFtb3VudCAqIC0xOwogICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuYW5pbWF0ZVNoaXAoZ2FtZUNvbnRleHQsICJkYW1hZ2UiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQWRkIGxpZmUKICAgICAgICAgICAgZWxzZSBpZiAoYW1vdW50ID4gMCkgewogICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQubGlmZSArPSBhbW91bnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJZiBkZWFkCiAgICAgICAgICBpZiAoYW1vdW50ID09PSAiZGVhdGgiIHx8ICFjb21wb25lbnRDb250ZXh0LnNoaXBBbGl2ZSkgewogICAgICAgICAgICBpZiAob2JqZWN0TmFtZSkgewogICAgICAgICAgICAgIGdhbWVDb250ZXh0LnNvdW5kcy5kZWF0aFtvYmplY3ROYW1lXS5wbGF5KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdhbWVDb250ZXh0LnZ1bG5lcmFibGUgPSBmYWxzZTsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGdhbWVDb250ZXh0LnZ1bG5lcmFiaWxpdHlUaW1lcik7CiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQubGlmZSA9IDA7CiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuYW5pbWF0ZVNoaXAoZ2FtZUNvbnRleHQsICJkZWF0aCIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnJlbW92ZUFsbE9iamVjdHMoKTsKICAgICAgICAgICAgICBsaWZlQ2hlY2soKTsKICAgICAgICAgICAgfSwgMjAwMCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXNldFZ1bG5lcmFiaWxpdHkoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZGRTaGlwKGdhbWVDb250ZXh0KSB7CiAgICAgIGNvbnN0IGNvbXBvbmVudENvbnRleHQgPSB0aGlzOwogICAgICBjb21wb25lbnRDb250ZXh0LnN5c3RlbVNvdW5kKCdzaGlwLWVudHJhbmNlJyk7CgogICAgICBpZiAoY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5zaGlwKSB7CiAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5zaGlwLnNldEFjdGl2ZShmYWxzZSkuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5zaGlwLmRlc3Ryb3koKTsKICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnNoaXAgPSB7fTsKICAgICAgfQogICAgICBnYW1lQ29udGV4dC5zaGlwID0gZ2FtZUNvbnRleHQucGh5c2ljcy5hZGQKICAgICAgICAuc3ByaXRlKGNvbXBvbmVudENvbnRleHQueCwgY29tcG9uZW50Q29udGV4dC55LCAic2hpcCIpCiAgICAgICAgLnNldERlcHRoKDEpOwogICAgICBnYW1lQ29udGV4dC5zaGlwLmJvZHkuc2V0QWxsb3dHcmF2aXR5KGZhbHNlKTsKICAgICAgY29tcG9uZW50Q29udGV4dC5saWZlID0gMTAwOwogICAgICBnYW1lQ29udGV4dC52dWxuZXJhYmxlID0gdHJ1ZTsKICAgICAgY29tcG9uZW50Q29udGV4dC5zaGlwRmxvYXQoZ2FtZUNvbnRleHQpOwoKICAgICAgZ2FtZUNvbnRleHQucGh5c2ljcy5hZGQub3ZlcmxhcCgKICAgICAgICBnYW1lQ29udGV4dC5idWxsZXRzLAogICAgICAgIGdhbWVDb250ZXh0LnNoaXAsCiAgICAgICAgZnVuY3Rpb24gKG9iamVjdCwgYnVsbGV0KSB7CiAgICAgICAgICBpZiAoYnVsbGV0LmZyaWVuZGx5RmlyZSkgewogICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnNoaXBMaWZlKGdhbWVDb250ZXh0LCAtMjUsICJidWxsZXQiKTsKICAgICAgICAgICAgYnVsbGV0LnNldEFjdGl2ZShmYWxzZSkuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICApOwogICAgfSwKCiAgICBzdGFydExldmVsKCkgewogICAgICBjb25zdCBjb21wb25lbnRDb250ZXh0ID0gdGhpczsKCiAgICAgIC8vIFNldCBsZXZlbCBncmF2aXR5CiAgICAgIGlmIChjb21wb25lbnRDb250ZXh0LmN1cnJlbnRMZXZlbC5ncmF2aXR5KSB7CiAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5waHlzaWNzLndvcmxkLmdyYXZpdHkueSA9IGNvbXBvbmVudENvbnRleHQuY3VycmVudExldmVsLmdyYXZpdHk7CiAgICAgIH0KCiAgICAgIC8vIFBsYXkgYmVhdAogICAgICBjb21wb25lbnRDb250ZXh0LnBsYXlCZWF0KGNvbXBvbmVudENvbnRleHQpOwogICAgfSwKICAgIGdldExlYWRlckJvYXJkKCkgewogICAgICB2YXIgY29tcG9uZW50Q29udGV4dCA9IHRoaXM7CiAgICAgIGNvbXBvbmVudENvbnRleHQuJHN0b3JlLmRpc3BhdGNoKCdnZXRMZWFkZXJCb2FyZCcpOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIGNvbnN0IGNvbXBvbmVudENvbnRleHQgPSB0aGlzOwogICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29uZmlnID0gewogICAgICBwYXJlbnQ6ICJQaGFzZXJHYW1lIiwKICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLAogICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCwKICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsCiAgICAgIHR5cGU6IFBoYXNlci5BVVRPLAogICAgICBzY2VuZTogewogICAgICAgIHBoeXNpY3M6IHsKICAgICAgICAgIGFyY2FkZTogewogICAgICAgICAgICBkZWJ1ZzogZmFsc2UsCiAgICAgICAgICAgIGdyYXZpdHk6IHsgeDogMCwgeTogNTAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICBtYXR0ZXI6IHsKICAgICAgICAgICAgZ3Jhdml0eTogeyB5OiAwIH0sCiAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgIC8vdGhpcy5jYW1lcmFzLm1haW4uc2V0QmFja2dyb3VuZENvbG9yKCd0cmFuc3BhcmVudCcpOyAvLyBTZXQgYmFja2dyb3VuZCBjb2xvcgogICAgICAgIH0sCiAgICAgICAgcHJlbG9hZCgpIHsKICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzOwogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dCA9IHRoaXM7CgogICAgICAgICAgLy8gTE9BRCBBUlRXT1JLCgogICAgICAgICAgLy8gU2hpcCBhbmQgV2VhcG9ucwogICAgICAgICAgY29udGV4dC5sb2FkLnNwcml0ZXNoZWV0KCJzaGlwIiwgImltYWdlL3NoaXAuc3ZnIiwgewogICAgICAgICAgICBmcmFtZVdpZHRoOiA1MCwKICAgICAgICAgICAgaGVpZ2h0OiA1MCwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGV4dC5sb2FkLmltYWdlKCJidWxsZXQiLCAiaW1hZ2Uvc2hpcC1idWxsZXQuc3ZnIik7CgogICAgICAgICAgLy8gTGlmZSBPYmplY3RzCiAgICAgICAgICBjb250ZXh0LmxvYWQuaW1hZ2UoImxpZmViYXNlIiwgImltYWdlL2xpZmViYXNlLnN2ZyIsIHsKICAgICAgICAgICAgZnJhbWVXaWR0aDogNjAsCiAgICAgICAgICAgIGhlaWdodDogNDAsCiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBEZWF0aCBvYmplY3RzCiAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmRlYXRoT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChvYmplY3RPYmosIGluZGV4KSB7CiAgICAgICAgICAgIGNvbnN0IG9iamVjdE5hbWUgPSAiZGVhdGgtIiArIG9iamVjdE9iai5uYW1lOwogICAgICAgICAgICBjb250ZXh0LmxvYWQuc3ByaXRlc2hlZXQoCiAgICAgICAgICAgICAgb2JqZWN0TmFtZSwKICAgICAgICAgICAgICAiaW1hZ2UvIiArIG9iamVjdE5hbWUgKyAiLnN2ZyIsCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZnJhbWVXaWR0aDogb2JqZWN0T2JqLndpZHRoLAogICAgICAgICAgICAgICAgZnJhbWVIZWlnaHQ6IG9iamVjdE9iai5oZWlnaHQsCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gR29vZCBvYmplY3RzCiAgICAgICAgICBjb21wb25lbnRDb250ZXh0Lmdvb2RPYmplY3RzLmZvckVhY2goZnVuY3Rpb24gKG9iamVjdE9iaiwgaW5kZXgpIHsKICAgICAgICAgICAgY29uc3Qgb2JqZWN0TmFtZSA9IG9iamVjdE9iai5uYW1lOwogICAgICAgICAgICBjb250ZXh0LmxvYWQuc3ByaXRlc2hlZXQoCiAgICAgICAgICAgICAgb2JqZWN0TmFtZSwKICAgICAgICAgICAgICAiaW1hZ2UvIiArIG9iamVjdE5hbWUgKyAiLnN2ZyIsCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZnJhbWVXaWR0aDogb2JqZWN0T2JqLndpZHRoLAogICAgICAgICAgICAgICAgZnJhbWVIZWlnaHQ6IG9iamVjdE9iai5oZWlnaHQsCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gU291bmQgRWZmZWN0cwogICAgICAgICAgLypjb250ZXh0LmxvYWQuYXVkaW8oImNvbnRpbnVlIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9jb250aW51ZS5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9jb250aW51ZS5tcDMiLAogICAgICAgICAgXSk7CiAgICAgICAgICBjb250ZXh0LmxvYWQuYXVkaW8oImdvIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9nby5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9nby5tcDMiLAogICAgICAgICAgXSk7Ki8KCiAgICAgICAgICAvLyBXZWFwb25zCiAgICAgICAgICBjb250ZXh0LmxvYWQuYXVkaW8oImd1bi0xIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9ndW4tMS5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9ndW4tMS5tcDMiLAogICAgICAgICAgXSk7CiAgICAgICAgICBjb250ZXh0LmxvYWQuYXVkaW8oImd1bi0yIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9ndW4tMi5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9ndW4tMi5tcDMiLAogICAgICAgICAgXSk7CgogICAgICAgICAgLy8gRGFtYWdlCiAgICAgICAgICBjb250ZXh0LmxvYWQuYXVkaW8oImRhbWFnZS1zdGFyIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kYW1hZ2Utc3Rhci5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kYW1hZ2Utc3Rhci5tcDMiLAogICAgICAgICAgXSk7CiAgICAgICAgICBjb250ZXh0LmxvYWQuYXVkaW8oImRhbWFnZS1idWxsZXQiLCBbCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2RhbWFnZS1idWxsZXQub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvZGFtYWdlLWJ1bGxldC5tcDMiLAogICAgICAgICAgXSk7CgogICAgICAgICAgLy8gRGVhdGgKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygiZGVzdHJveS1jb21ldCIsIFsKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvZGVzdHJveS1jb21ldC5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kZXN0cm95LWNvbWV0Lm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygiZGVzdHJveS1zdHJvaWQiLCBbCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2Rlc3Ryb3ktc3Ryb2lkLm9nZyIsCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2Rlc3Ryb3ktc3Ryb2lkLm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygiZGVzdHJveS1zdGFyIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kZXN0cm95LXN0YXIub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvZGVzdHJveS1zdGFyLm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygic3BpcmFsLXJpY29jaGV0IiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9zcGlyYWwtcmljb2NoZXQub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvc3BpcmFsLXJpY29jaGV0Lm1wMyIsCiAgICAgICAgICBdKTsKCiAgICAgICAgICAvLyBEZWF0aAogICAgICAgICAgY29udGV4dC5sb2FkLmF1ZGlvKCJkZWF0aC1jb21ldCIsIFsKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvZGVhdGgtY29tZXQub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvZGVhdGgtY29tZXQubXAzIiwKICAgICAgICAgIF0pOwogICAgICAgICAgY29udGV4dC5sb2FkLmF1ZGlvKCJkZWF0aC1zdHJvaWQiLCBbCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2RlYXRoLXN0cm9pZC5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kZWF0aC1zdHJvaWQubXAzIiwKICAgICAgICAgIF0pOwogICAgICAgICAgY29udGV4dC5sb2FkLmF1ZGlvKCJkZWF0aC1zdGFyIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kZWF0aC1zdGFyLm9nZyIsCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2RlYXRoLXN0YXIubXAzIiwKICAgICAgICAgIF0pOwogICAgICAgICAgY29udGV4dC5sb2FkLmF1ZGlvKCJkZWF0aC1zcGlyYWwiLCBbCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2RlYXRoLXNwaXJhbC5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kZWF0aC1zcGlyYWwubXAzIiwKICAgICAgICAgIF0pOwogICAgICAgICAgY29udGV4dC5sb2FkLmF1ZGlvKCJkZWF0aC1idWxsZXQiLCBbCiAgICAgICAgICAgICJhdWRpby9lZmZlY3RzL2RlYXRoLWJ1bGxldC5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9kZWF0aC1idWxsZXQubXAzIiwKICAgICAgICAgIF0pOwoKICAgICAgICAgIC8vIEdvb2QKICAgICAgICAgIC8qCiAgICAgICAgICBjb250ZXh0LmxvYWQuYXVkaW8oImxpZmViYXNlIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9saWZlYmFzZS5vZ2ciLAogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9saWZlYmFzZS5tcDMiLAogICAgICAgICAgXSk7Ki8KICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygicG9pbnQtc3Rhci0xIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9wb2ludC1zdGFyLTEub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvcG9pbnQtc3Rhci0xLm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygicG9pbnQtc3Rhci0yIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9wb2ludC1zdGFyLTIub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvcG9pbnQtc3Rhci0yLm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygicG9pbnQtc3Rhci0zIiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9wb2ludC1zdGFyLTMub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvcG9pbnQtc3Rhci0zLm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygicG9pbnQtc3Rhci00IiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9wb2ludC1zdGFyLTQub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvcG9pbnQtc3Rhci00Lm1wMyIsCiAgICAgICAgICBdKTsKICAgICAgICAgIGNvbnRleHQubG9hZC5hdWRpbygicG9pbnQtc3Rhci1kZXN0cm95IiwgWwogICAgICAgICAgICAiYXVkaW8vZWZmZWN0cy9wb2ludC1zdGFyLWRlc3Ryb3kub2dnIiwKICAgICAgICAgICAgImF1ZGlvL2VmZmVjdHMvcG9pbnQtc3Rhci1kZXN0cm95Lm1wMyIsCiAgICAgICAgICBdKTsKCiAgICAgICAgfSwKICAgICAgICBjcmVhdGUoKSB7CiAgICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpczsKICAgICAgICAgIAogICAgICAgICAgLy8gU3RvcmUgcmVzZXQgZnVuY3Rpb24KICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZGVzdHJveUdhbWUgPSB7CiAgICAgICAgICAgIGZ1bmM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBjb250ZXh0LnN5cy5nYW1lLmRlc3Ryb3kodHJ1ZSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9OwoKICAgICAgICAgIC8vIEFuaW1hdGlvbnMKICAgICAgICAgIGNvbnRleHQuYW5pbXMuY3JlYXRlKHsKICAgICAgICAgICAga2V5OiAiZmxvYXQiLAogICAgICAgICAgICBmcmFtZVJhdGU6IDUsCiAgICAgICAgICAgIGZyYW1lczogdGhpcy5hbmltcy5nZW5lcmF0ZUZyYW1lTnVtYmVycygic2hpcCIsIHsKICAgICAgICAgICAgICBzdGFydDogMiwKICAgICAgICAgICAgICBlbmQ6IDIsCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICByZXBlYXQ6IC0wLAogICAgICAgICAgfSk7CiAgICAgICAgICBjb250ZXh0LmFuaW1zLmNyZWF0ZSh7CiAgICAgICAgICAgIGtleTogImdvIiwKICAgICAgICAgICAgZnJhbWVSYXRlOiA1LAogICAgICAgICAgICBmcmFtZXM6IHRoaXMuYW5pbXMuZ2VuZXJhdGVGcmFtZU51bWJlcnMoInNoaXAiLCB7CiAgICAgICAgICAgICAgc3RhcnQ6IDMsCiAgICAgICAgICAgICAgZW5kOiAzLAogICAgICAgICAgICB9KSwKICAgICAgICAgICAgcmVwZWF0OiAtMSwKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGV4dC5hbmltcy5jcmVhdGUoewogICAgICAgICAgICBrZXk6ICJyZXN0b3JlIiwKICAgICAgICAgICAgZnJhbWVSYXRlOiAxMCwKICAgICAgICAgICAgZnJhbWVzOiB0aGlzLmFuaW1zLmdlbmVyYXRlRnJhbWVOdW1iZXJzKCJzaGlwIiwgeyBmcmFtZXM6IFswLCAyXSB9KSwKICAgICAgICAgICAgcmVwZWF0OiAzLAogICAgICAgICAgfSk7CiAgICAgICAgICBjb250ZXh0LmFuaW1zLmNyZWF0ZSh7CiAgICAgICAgICAgIGtleTogImRhbWFnZSIsCiAgICAgICAgICAgIGZyYW1lUmF0ZTogMTAsCiAgICAgICAgICAgIGZyYW1lczogdGhpcy5hbmltcy5nZW5lcmF0ZUZyYW1lTnVtYmVycygic2hpcCIsIHsgZnJhbWVzOiBbMSwgMl0gfSksCiAgICAgICAgICAgIHJlcGVhdDogMywKICAgICAgICAgIH0pOwogICAgICAgICAgY29udGV4dC5hbmltcy5jcmVhdGUoewogICAgICAgICAgICBrZXk6ICJkZWF0aCIsCiAgICAgICAgICAgIGZyYW1lUmF0ZTogNSwKICAgICAgICAgICAgZnJhbWVzOiB0aGlzLmFuaW1zLmdlbmVyYXRlRnJhbWVOdW1iZXJzKCJzaGlwIiwgewogICAgICAgICAgICAgIHN0YXJ0OiA0LAogICAgICAgICAgICAgIGVuZDogNCwKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHJlcGVhdDogLTAsCiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBXZWFwb25zCiAgICAgICAgICBjb250ZXh0LmJ1bGxldHMgPSBuZXcgQnVsbGV0cyhjb250ZXh0KTsKICAgICAgICAgIGNvbnRleHQuaW5wdXQub24oInBvaW50ZXJkb3duIiwgKHBvaW50ZXIpID0+IHsKICAgICAgICAgICAgaWYgKGNvbXBvbmVudENvbnRleHQuc2hpcEFsaXZlKSB7CiAgICAgICAgICAgICAgdGhpcy5idWxsZXRzLmZpcmVCdWxsZXQodGhpcy5zaGlwLngsIHRoaXMuc2hpcC55IC0gMjApOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBBZGQgc2hpcAogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5hZGRTaGlwKGNvbnRleHQpOwoKICAgICAgICAgIC8vIEdvb2Qgb2JqZWN0cwogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nb29kT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChvYmplY3RPYmosIGluZGV4KSB7CiAgICAgICAgICAgIGNvbnN0IG9iamVjdE5hbWUgPSBvYmplY3RPYmoubmFtZTsKICAgICAgICAgICAgICBjb250ZXh0LmFuaW1zLmNyZWF0ZSh7CiAgICAgICAgICAgICAgICBrZXk6IG9iamVjdE5hbWUsCiAgICAgICAgICAgICAgICBmcmFtZVJhdGU6IDEsCiAgICAgICAgICAgICAgICBmcmFtZXM6IGNvbnRleHQuYW5pbXMuZ2VuZXJhdGVGcmFtZU51bWJlcnMob2JqZWN0TmFtZSwgewogICAgICAgICAgICAgICAgICBzdGFydDogMSwKICAgICAgICAgICAgICAgICAgZW5kOiAxLAogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICByZXBlYXQ6IC0wLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gRGVhdGggb2JqZWN0cwogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5kZWF0aE9iamVjdHMuZm9yRWFjaChmdW5jdGlvbiAob2JqZWN0T2JqLCBpbmRleCkgewogICAgICAgICAgICBjb25zdCBvYmplY3ROYW1lID0gImRlYXRoLSIgKyBvYmplY3RPYmoubmFtZTsKICAgICAgICAgICAgaWYgKG9iamVjdE9iai5uYW1lICE9ICJzcGlyYWwiKSB7CiAgICAgICAgICAgICAgY29udGV4dC5hbmltcy5jcmVhdGUoewogICAgICAgICAgICAgICAga2V5OiAiZGVzdHJveS0iICsgb2JqZWN0T2JqLm5hbWUsCiAgICAgICAgICAgICAgICBmcmFtZVJhdGU6IDEsCiAgICAgICAgICAgICAgICBmcmFtZXM6IGNvbnRleHQuYW5pbXMuZ2VuZXJhdGVGcmFtZU51bWJlcnMob2JqZWN0TmFtZSwgewogICAgICAgICAgICAgICAgICBzdGFydDogMSwKICAgICAgICAgICAgICAgICAgZW5kOiAxLAogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICByZXBlYXQ6IC0wLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCgogICAgICAgICAgLy8gTG9hZCBzb3VuZCBlZmZlY3RzCiAgICAgICAgICBjb250ZXh0LnNvdW5kcyA9IHsKICAgICAgICAgICAgYnV0dG9uOiB7CiAgICAgICAgICAgICAgLy8gc2VsZWN0OiBjb250ZXh0LnNvdW5kLmFkZCgic2VsZWN0IiksCiAgICAgICAgICAgICAgLy9jb250aW51ZTogY29udGV4dC5zb3VuZC5hZGQoImNvbnRpbnVlIiksCiAgICAgICAgICAgICAgLy9nbzogY29udGV4dC5zb3VuZC5hZGQoImdvIikKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3BvaW50LXN0YXInOiBbY29udGV4dC5zb3VuZC5hZGQoInBvaW50LXN0YXItMSIpLCBjb250ZXh0LnNvdW5kLmFkZCgicG9pbnQtc3Rhci0yIiksY29udGV4dC5zb3VuZC5hZGQoInBvaW50LXN0YXItMyIpLGNvbnRleHQuc291bmQuYWRkKCJwb2ludC1zdGFyLTQiKV0sCiAgICAgICAgICAgIGd1bjogW2NvbnRleHQuc291bmQuYWRkKCJndW4tMSIpLCBjb250ZXh0LnNvdW5kLmFkZCgiZ3VuLTIiKV0sCiAgICAgICAgICAgIGRlYXRoOiB7CiAgICAgICAgICAgICAgY29tZXQ6IGNvbnRleHQuc291bmQuYWRkKCJkZWF0aC1jb21ldCIpLAogICAgICAgICAgICAgIHN0cm9pZDogY29udGV4dC5zb3VuZC5hZGQoImRlYXRoLXN0cm9pZCIpLAogICAgICAgICAgICAgIHN0YXI6IGNvbnRleHQuc291bmQuYWRkKCJkZWF0aC1zdGFyIiksCiAgICAgICAgICAgICAgc3BpcmFsOiBjb250ZXh0LnNvdW5kLmFkZCgiZGVhdGgtc3BpcmFsIiksCiAgICAgICAgICAgICAgYnVsbGV0OiBjb250ZXh0LnNvdW5kLmFkZCgiZGVhdGgtYnVsbGV0IiksCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRlc3Ryb3k6IHsKICAgICAgICAgICAgICBjb21ldDogY29udGV4dC5zb3VuZC5hZGQoImRlc3Ryb3ktY29tZXQiKSwKICAgICAgICAgICAgICBzdHJvaWQ6IGNvbnRleHQuc291bmQuYWRkKCJkZXN0cm95LXN0cm9pZCIpLAogICAgICAgICAgICAgIHN0YXI6IGNvbnRleHQuc291bmQuYWRkKCJkZXN0cm95LXN0YXIiKSwKICAgICAgICAgICAgICAic3BpcmFsLXJpY29jaGV0IjogY29udGV4dC5zb3VuZC5hZGQoInNwaXJhbC1yaWNvY2hldCIpLAogICAgICAgICAgICAgICJwb2ludC1zdGFyLWRlc3Ryb3kiOiBjb250ZXh0LnNvdW5kLmFkZCgicG9pbnQtc3Rhci1kZXN0cm95IiksCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhbWFnZTogewogICAgICAgICAgICAgIHN0YXI6IGNvbnRleHQuc291bmQuYWRkKCJkYW1hZ2Utc3RhciIpLAogICAgICAgICAgICAgIGJ1bGxldDogY29udGV4dC5zb3VuZC5hZGQoImRhbWFnZS1idWxsZXQiKSwKICAgICAgICAgICAgfSwKICAgICAgICAgIH07CgogICAgICAgICAgLy8gU3RhcnQgbXVzaWMg8J+OtfCfjrXwn461CiAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnN0YXJ0TGV2ZWwoKTsKICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZVN0YXR1cyA9ICJzdGFydGVkIjsKICAgICAgICB9LAogICAgICAgIHVwZGF0ZSh0aW1lLCBkZWx0YSkgewogICAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXM7CiAgICAgICAgICBsZXQgeyB3aWR0aCwgaGVpZ2h0IH0gPSBjb250ZXh0LnN5cy5nYW1lLmNhbnZhczsKCiAgICAgICAgICBpZiAoY29tcG9uZW50Q29udGV4dC5nYW1lU3RhdHVzICE9PSAib3ZlciIgJiYgY29tcG9uZW50Q29udGV4dC5nYW1lU3RhdHVzICE9PSAiY29tcGxldGUiKSB7CiAgICAgICAgICAgIHdoaWxlICgKICAgICAgICAgICAgICAhY29tcG9uZW50Q29udGV4dC51cGRhdGVUaW1lciB8fAogICAgICAgICAgICAgIHRpbWUgPiBjb21wb25lbnRDb250ZXh0LnVwZGF0ZVRpbWVyICsgY29tcG9uZW50Q29udGV4dC51cGRhdGVUaW1lCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIGNvbnN0IHNwYXduUGFkZGluZyA9IDIwOwogICAgICAgICAgICAgIAogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIFBvaW50IHN0YXJzCiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5jdXJyZW50UG9pbnRTdGFycy5sZW5ndGggPD0gMjAKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgY29uc3QgcG9pbnRTdGFyWCA9IFBoYXNlci5NYXRoLkJldHdlZW4oCiAgICAgICAgICAgICAgICAgICAgc3Bhd25QYWRkaW5nLAogICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZ2FtZS5jb25maWcud2lkdGggLSBzcGF3blBhZGRpbmcKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgbGV0IHBvaW50U3RhciA9IG5ldyBQb2ludFN0YXIoCiAgICAgICAgICAgICAgICAgICAgY29udGV4dCwKICAgICAgICAgICAgICAgICAgICBwb2ludFN0YXJYLAogICAgICAgICAgICAgICAgICAgIDAKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgCgogICAgICAgICAgICAgIC8vIERlYXRoIG9iamVjdHMKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmF1ZGlvLm1pZEJhc3MgJiYKICAgICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudERlYXRoT2JqZWN0cy5sZW5ndGggPCAxNQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0VHlwZSA9IGNvbXBvbmVudENvbnRleHQucmFuZG9tSXRlbVByb2JhYmxpdHkoY29tcG9uZW50Q29udGV4dC5kZWF0aE9iamVjdHMpOwogICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0TmFtZSA9IG9iamVjdFR5cGUubmFtZTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25zdCB4UG9zaXRpb24gPSBQaGFzZXIuTWF0aC5CZXR3ZWVuKAogICAgICAgICAgICAgICAgICBzcGF3blBhZGRpbmcsCiAgICAgICAgICAgICAgICAgIGNvbnRleHQuZ2FtZS5jb25maWcud2lkdGggLSBzcGF3blBhZGRpbmcKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgLy8gU2VuZCBvYmplY3QKICAgICAgICAgICAgICAgIGxldCBkZWF0aE9iamVjdCA9IG5ldyBEZWF0aE9iamVjdCgKICAgICAgICAgICAgICAgICAgY29udGV4dCwKICAgICAgICAgICAgICAgICAgeFBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICBvYmplY3ROYW1lCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnVwZGF0ZVRpbWVyID0gdGltZTsgLy8gUmVzZXQgdGltZXIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRGVhdGggc3BpcmFscwogICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmN1cnJlbnREZWF0aE9iamVjdHMKICAgICAgICAgICAgICAuZmlsdGVyKChvYmplY3QpID0+IG9iamVjdC5uYW1lID09PSAic3BpcmFsIikKICAgICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoc3BpcmFsKSB7CiAgICAgICAgICAgICAgICBzcGlyYWwub2JqZWN0LnJvdGF0aW9uICs9IDAuMTI1OwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gRGVhdGggYnkgc3BpcmFsCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmxpZmUgPT09IDAgJiYKICAgICAgICAgICAgICBjb250ZXh0LmRlYXRoQnlTcGlyYWwgJiYKICAgICAgICAgICAgICBjb250ZXh0LmRlYXRoQnlTcGlyYWwub2JqZWN0CiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIGNvbnRleHQuc2hpcC5zZXRPcmlnaW4oMC41LCAwLjUpOwogICAgICAgICAgICAgIGNvbnRleHQuc2hpcC5hbmdsZSArPSAyNTsKICAgICAgICAgICAgICBjb250ZXh0LnBoeXNpY3MubW92ZVRvT2JqZWN0KAogICAgICAgICAgICAgICAgY29udGV4dC5zaGlwLAogICAgICAgICAgICAgICAgY29udGV4dC5kZWF0aEJ5U3BpcmFsLm9iamVjdCwKICAgICAgICAgICAgICAgIDUwMAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgaWYgKGNvbnRleHQuc2hpcC5zY2FsZSA+IDApIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuc2hpcC5zY2FsZSAtPSAwLjE7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnRleHQuc2hpcC5zY2FsZSA9IDA7CiAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnNoaXBMaWZlKGNvbnRleHQsICJkZWF0aCIpOwogICAgICAgICAgICAgICAgY29udGV4dC5kZWF0aEJ5U3BpcmFsID0gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBQcm9jZXNzIHBvaW50IHN0YXJzCiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudFBvaW50U3RhcnMuZm9yRWFjaChmdW5jdGlvbiAoCiAgICAgICAgICAgICAgcG9pbnRTdGFyCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIGlmIChwb2ludFN0YXIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG9iamVjdFBvc2l0aW9uID0gewogICAgICAgICAgICAgICAgICB4OiBwb2ludFN0YXIub2JqZWN0LngsCiAgICAgICAgICAgICAgICAgIHk6IHBvaW50U3Rhci5vYmplY3QueSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgIG9iamVjdFBvc2l0aW9uLnkgPgogICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuZ2FtZS5jb25maWcuaGVpZ2h0IHx8CiAgICAgICAgICAgICAgICAgIG9iamVjdFBvc2l0aW9uLnkgPCAwCiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5kZXN0cm95UG9pbnRTdGFyKHBvaW50U3Rhci5pZCk7ICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIAoKICAgICAgICAgICAgLy8gUHJvY2VzcyBEZWF0aCBvYmplY3RzCiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudERlYXRoT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uICgKICAgICAgICAgICAgICBkZWF0aE9iamVjdAogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBpZiAoZGVhdGhPYmplY3QpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG9iamVjdFBvc2l0aW9uID0gewogICAgICAgICAgICAgICAgICB4OiBkZWF0aE9iamVjdC5vYmplY3QueCwKICAgICAgICAgICAgICAgICAgeTogZGVhdGhPYmplY3Qub2JqZWN0LnksCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICBvYmplY3RQb3NpdGlvbi55ID4KICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LmdhbWUuY29uZmlnLmhlaWdodCB8fAogICAgICAgICAgICAgICAgICBvYmplY3RQb3NpdGlvbi55IDwgMAogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQucmVtb3ZlT2JqZWN0KGRlYXRoT2JqZWN0KTsKICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuc2hpcEFsaXZlICYmCiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5tb3ZlbWVudFNjb3JlVHJpZ2dlcgogICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnVwZGF0ZVNjb3JlKDEwKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgfSwKICAgIH07CgogICAgY29uc3QgYm90dG9tUGFkZGluZyA9IDUwOwogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIiwgZnVuY3Rpb24gKGV2dCkgewogICAgICBpZiAoY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dCkgewogICAgICAgIC8vIENoZWNrIGlmIGdhbWUgcmVhZHkKCiAgICAgICAgLy8gQW5pbWF0aW9uCiAgICAgICAgY29uc3Qgc3RhbGxUaW1lID0gNTAwOwogICAgICAgIGNvbXBvbmVudENvbnRleHQuYW5pbWF0ZVNoaXAoY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dCwgImdvIik7IC8vIEFjY2VsZXJhdGlvbiBhbmltYXRpb24KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuc2hpcEZsb2F0KGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQpOyAvLyBGbG9hdCBhZnRlciBzdGFsbCB0aW1lCiAgICAgICAgfSwgc3RhbGxUaW1lKTsKCiAgICAgICAgLy8gRm9sbG93IG1vdXNlCiAgICAgICAgaWYgKGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc2hpcCAmJiBjb21wb25lbnRDb250ZXh0LnNoaXBBbGl2ZSkgewogICAgICAgICAgY29uc3QgZmx5Q29uZmlnID0gewogICAgICAgICAgICB0YXJnZXRzOiBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnNoaXAsCiAgICAgICAgICAgIHg6IGV2dC5jbGllbnRYLAogICAgICAgICAgICBkdXJhdGlvbjogMjUwLAogICAgICAgICAgICBlYXNlOiAiU2luZS5lYXNlT3V0IiwKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKGNvbXBvbmVudENvbnRleHQuZ2FtZVN0YXR1cyA9PT0gJ2NvbXBsZXRlJyB8fCBldnQuY2xpZW50WSA+PSBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LmdhbWUuY29uZmlnLmhlaWdodCAvIDIgJiYgZXZ0LmNsaWVudFkgPD0gY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5nYW1lLmNvbmZpZy5oZWlnaHQgLSBib3R0b21QYWRkaW5nCiAgICAgICAgICApIHsKICAgICAgICAgICAgZmx5Q29uZmlnLnkgPSBldnQuY2xpZW50WTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQudHdlZW5zLmFkZChmbHlDb25maWcsIHRoaXMpOwoKICAgICAgICAgIC8vIE1vdmVtZW50IHNjb3JlIGNvbnRyb2wKICAgICAgICAgIGNvbnN0IGNhbXBpbmdUaW1lID0gNTAwMDsKICAgICAgICAgIGNsZWFyVGltZW91dChjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0Lm1vdmVtZW50U2NvcmVUaW1lcik7CiAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0Lm1vdmVtZW50U2NvcmVUcmlnZ2VyID0gdHJ1ZTsKICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQubW92ZW1lbnRTY29yZVRpbWVyID0gc2V0VGltZW91dCgKICAgICAgICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQubW92ZW1lbnRTY29yZVRyaWdnZXIgPSBmYWxzZTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2FtcGluZ1RpbWUKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKCiAgICBjbGFzcyBCdWxsZXQgZXh0ZW5kcyBQaGFzZXIuUGh5c2ljcy5BcmNhZGUuU3ByaXRlIHsKICAgICAgY29uc3RydWN0b3Ioc2NlbmUsIHgsIHkpIHsKICAgICAgICBzdXBlcihzY2VuZSwgeCwgeSwgImJ1bGxldCIpOwogICAgICB9CgogICAgICBmaXJlKHgsIHkpIHsKICAgICAgICB0aGlzLnJvdGF0aW9uID0gMDsKICAgICAgICB0aGlzLmZyaWVuZGx5RmlyZSA9IGZhbHNlOwogICAgICAgIHRoaXMucmljaG9jaGV0RGVjaWRlZCA9IGZhbHNlOwogICAgICAgIHRoaXMuYm9keS5yZXNldCh4LCB5KTsKCiAgICAgICAgdGhpcy5zZXRBY3RpdmUodHJ1ZSk7CiAgICAgICAgdGhpcy5zZXRWaXNpYmxlKHRydWUpOwoKICAgICAgICB0aGlzLnNldFZlbG9jaXR5WShjb21wb25lbnRDb250ZXh0LmJ1bGxldFNwZWVkICogLTEpOwogICAgICB9CgogICAgICBwcmVVcGRhdGUodGltZSwgZGVsdGEpIHsKICAgICAgICBzdXBlci5wcmVVcGRhdGUodGltZSwgZGVsdGEpOwoKICAgICAgICBpZiAoCiAgICAgICAgICB0aGlzLnkgPCAwIHx8CiAgICAgICAgICB0aGlzLnkgPiBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LmdhbWUuY29uZmlnLmhlaWdodAogICAgICAgICkgewogICAgICAgICAgdGhpcy5zZXRBY3RpdmUoZmFsc2UpOwogICAgICAgICAgdGhpcy5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICAgIHRoaXMueSA9IC0xMDA7CiAgICAgICAgICB0aGlzLnggPSAtMTAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgY2xhc3MgQnVsbGV0cyBleHRlbmRzIFBoYXNlci5QaHlzaWNzLkFyY2FkZS5Hcm91cCB7CiAgICAgIGNvbnN0cnVjdG9yKHNjZW5lKSB7CiAgICAgICAgc3VwZXIoc2NlbmUucGh5c2ljcy53b3JsZCwgc2NlbmUpOwoKICAgICAgICB0aGlzLmNyZWF0ZU11bHRpcGxlKHsKICAgICAgICAgIGZyYW1lUXVhbnRpdHk6IDcsCiAgICAgICAgICBrZXk6ICJidWxsZXQiLAogICAgICAgICAgYWN0aXZlOiBmYWxzZSwKICAgICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgICAgY2xhc3NUeXBlOiBCdWxsZXQsCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZpcmVCdWxsZXQoeCwgeSkgewogICAgICAgIGxldCBidWxsZXQgPSB0aGlzLmdldEZpcnN0RGVhZChmYWxzZSk7CiAgICAgICAgaWYgKGJ1bGxldCkgewogICAgICAgICAgLy8gUGxheSByYW5kb20gZ3VuIHNvdW5kCiAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnNvdW5kcy5ndW5bCiAgICAgICAgICAgIE1hdGguZmxvb3IoCiAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKSAqIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc291bmRzLmd1bi5sZW5ndGgKICAgICAgICAgICAgKQogICAgICAgICAgXS5wbGF5KCk7CgogICAgICAgICAgYnVsbGV0LmZpcmUoeCwgeSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBjbGFzcyBEZWF0aE9iamVjdCBleHRlbmRzIFBoYXNlci5QaHlzaWNzLkFyY2FkZS5TcHJpdGUgewogICAgICBjb25zdHJ1Y3RvcihzY2VuZSwgeCwgeSwgbmFtZSkgewogICAgICAgIGNvbnN0IG9iamVjdE5hbWUgPSAiZGVhdGgtIiArIG5hbWU7CiAgICAgICAgY29uc3QgaWQgPSBEYXRlLm5vdygpOwogICAgICAgIGNvbnN0IGRlcHRoID0gbmFtZSA9PT0gJ3NwaXJhbCcgPyAtMTogMDsKICAgICAgICBzdXBlcihzY2VuZSwgeCwgeSwgb2JqZWN0TmFtZSk7CiAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5zY2VuZS5waHlzaWNzLmFkZAogICAgICAgICAgLnNwcml0ZSh4LCB5LCBvYmplY3ROYW1lKQogICAgICAgICAgLnNldERlcHRoKGRlcHRoKTsKICAgICAgICBjb25zdCBmaW5hbE9iamVjdCA9IHsKICAgICAgICAgIG9iamVjdDogb2JqZWN0LAogICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgIGlkOiBpZCwKICAgICAgICB9OwoKICAgICAgICAvLyBDb21ldAogICAgICAgIGlmIChuYW1lID09PSAiY29tZXQiKSB7CiAgICAgICAgICAvLyBIZWF0IHNlYWtpbmcgYXQgcmFuZG9tCiAgICAgICAgICBjb25zdCBoZWF0U2VlayA9IE1hdGgucmFuZG9tKCkgPCAwLjE7CiAgICAgICAgICBpZiAoaGVhdFNlZWspIHsKICAgICAgICAgICAgZmluYWxPYmplY3QuaGVhdFNlZWsgPSB0cnVlOwogICAgICAgICAgICBjb25zdCByb3RhdGlvbiA9IGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQucGh5c2ljcy5hY2NlbGVyYXRlVG8oCiAgICAgICAgICAgICAgb2JqZWN0LAogICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc2hpcC54LAogICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc2hpcC55LAogICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQucmFuZG9tTnVtYmVyKDI1MCwgNzUwKQogICAgICAgICAgICApOwogICAgICAgICAgICBvYmplY3Qucm90YXRpb24gPSByb3RhdGlvbiAtIDkwOyAvLyBIYWNrIHRvIGZpeCBpbmNvcnJlY3Qgcm90YXRpb247CiAgICAgICAgICAgIGZpbmFsT2JqZWN0LnBvaW50cyA9IDE1MDA7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBvYmplY3Quc2V0VmVsb2NpdHlZKGNvbXBvbmVudENvbnRleHQucmFuZG9tTnVtYmVyKDEwMCwgNjUwKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAobmFtZSA9PT0gInN0cm9pZCIpIHsKICAgICAgICAgIHZhciByYW5kb21TY2FsZSA9IGNvbXBvbmVudENvbnRleHQucmFuZG9tTnVtYmVyKDAuNzUsIDEuMjUpCiAgICAgICAgICBvYmplY3Quc2NhbGUgPSByYW5kb21TY2FsZTsKICAgICAgICAgIGNvbnN0IHJhbmRvbUNvbG9yID0gTWF0aC5yYW5kb20oKSAqIDB4ZmZmZmZmOwogICAgICAgICAgb2JqZWN0LnNldFRpbnQocmFuZG9tQ29sb3IscmFuZG9tQ29sb3IscmFuZG9tQ29sb3IscmFuZG9tQ29sb3IpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5hbWUgPT09ICJzcGlyYWwiKSB7CiAgICAgICAgICBvYmplY3Quc2NhbGUgPSAxLjU7CiAgICAgICAgfQoKICAgICAgICAvLyBCdWxsZXQgY29sbGlzaW9uCiAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5waHlzaWNzLmFkZC5vdmVybGFwKAogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5idWxsZXRzLAogICAgICAgICAgb2JqZWN0LAogICAgICAgICAgZnVuY3Rpb24gKG9iamVjdCwgYnVsbGV0KSB7CiAgICAgICAgICAgIGlmICghb2JqZWN0Lm5vdEFUaHJlYXQpIHsKICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gInNwaXJhbCIpIHsKICAgICAgICAgICAgICAgIGlmICghYnVsbGV0LnJpY2hvY2hldERlY2lkZWQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbVJpY29jaGV0ID0gTWF0aC5yYW5kb20oKSA8IDAuNTsKICAgICAgICAgICAgICAgICAgYnVsbGV0LnJpY2hvY2hldERlY2lkZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICBpZiAocmFuZG9tUmljb2NoZXQpIHsKICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnNvdW5kcy5kZXN0cm95WwogICAgICAgICAgICAgICAgICAgICAgInNwaXJhbC1yaWNvY2hldCIKICAgICAgICAgICAgICAgICAgICBdLnBsYXkoKTsKICAgICAgICAgICAgICAgICAgICBidWxsZXQuZnJpZW5kbHlGaXJlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBidWxsZXQucm90YXRpb24gKz0gMC41OwogICAgICAgICAgICAgICAgICAgIGJ1bGxldC5zZXRWZWxvY2l0eVkoY29tcG9uZW50Q29udGV4dC5idWxsZXRTcGVlZCAqIDAuNzUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IHBvaW50c0Vhcm5lZCA9IGZpbmFsT2JqZWN0LnBvaW50cwogICAgICAgICAgICAgICAgICA/IGZpbmFsT2JqZWN0LnBvaW50cwogICAgICAgICAgICAgICAgICA6IGNvbXBvbmVudENvbnRleHQuZGVhdGhPYmplY3RzLmZpbHRlcigKICAgICAgICAgICAgICAgICAgICAgIChvYmopID0+IG9iai5uYW1lID09PSBuYW1lCiAgICAgICAgICAgICAgICAgICAgKVswXS5wb2ludHM7CiAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnVwZGF0ZVNjb3JlKHBvaW50c0Vhcm5lZCk7CiAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmRlc3Ryb3lPYmplY3QoZmluYWxPYmplY3QpOwoKICAgICAgICAgICAgICAgIC8vIERpc3Bvc2UgYnVsbGV0CiAgICAgICAgICAgICAgICBidWxsZXQuc2V0QWN0aXZlKGZhbHNlKS5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICAgICAgICAgIGJ1bGxldC55ID0gLTEwMDsKICAgICAgICAgICAgICAgIGJ1bGxldC54ID0gLTEwMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICApOwoKICAgICAgICAvLyBTaGlwIGNvbGxpc2lvbgogICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQucGh5c2ljcy5hZGQub3ZlcmxhcCgKICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc2hpcCwKICAgICAgICAgIG9iamVjdCwKICAgICAgICAgIGZ1bmN0aW9uIChzaGlwLCBvYmplY3QpIHsKICAgICAgICAgICAgaWYgKCFvYmplY3Qubm90QVRocmVhdCAmJiBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnZ1bG5lcmFibGUpIHsKICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gInNwaXJhbCIpIHsKICAgICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc291bmRzLmRlYXRoLnNwaXJhbC5wbGF5KCk7CiAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmxpZmUgPSAwOwogICAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5kZWF0aEJ5U3BpcmFsID0gewogICAgICAgICAgICAgICAgICBvYmplY3Q6IG9iamVjdCwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSAic3RhciIpIHsKICAgICAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5zaGlwTGlmZSgKICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LAogICAgICAgICAgICAgICAgICAgIC0xMCwKICAgICAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gImNvbWV0IiAmJiAhZmluYWxPYmplY3QuaGVhdFNlZWspIHsKICAgICAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5zaGlwTGlmZSgKICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LAogICAgICAgICAgICAgICAgICAgIC01MCwKICAgICAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnNvdW5kcy5kZWF0aFtuYW1lXS5wbGF5KCk7CiAgICAgICAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuc2hpcExpZmUoCiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dCwKICAgICAgICAgICAgICAgICAgICAiZGVhdGgiCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmRlc3Ryb3lPYmplY3QoZmluYWxPYmplY3QpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudERlYXRoT2JqZWN0cy5wdXNoKGZpbmFsT2JqZWN0KTsKICAgICAgfQogICAgfQoKICAgIGNsYXNzIFBvaW50U3RhciBleHRlbmRzIFBoYXNlci5QaHlzaWNzLkFyY2FkZS5TcHJpdGUgewogICAgICBjb25zdHJ1Y3RvcihzY2VuZSwgeCwgeSwpIHsKICAgICAgICBjb25zdCBvYmplY3ROYW1lID0gJ3BvaW50LXN0YXInOwogICAgICAgIGNvbnN0IGlkID0gRGF0ZS5ub3coKTsKICAgICAgICBzdXBlcihzY2VuZSwgeCwgeSk7CiAgICAgICAgY29uc3Qgb2JqZWN0ID0gdGhpcy5zY2VuZS5waHlzaWNzLmFkZAogICAgICAgICAgLnNwcml0ZSh4LCB5LCAncG9pbnQtc3RhcicpCiAgICAgICAgICAuc2V0RGVwdGgoMCk7CiAgICAgICAgY29uc3QgZmluYWxPYmplY3QgPSB7CiAgICAgICAgICBvYmplY3Q6IG9iamVjdCwKICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICBpZDogaWQsCiAgICAgICAgfTsgICAgICAgIAoKICAgICAgICAvLyBCdWxsZXQgY29sbGlzaW9uCiAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5waHlzaWNzLmFkZC5vdmVybGFwKAogICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5idWxsZXRzLAogICAgICAgICAgb2JqZWN0LAogICAgICAgICAgZnVuY3Rpb24gKG9iamVjdCwgYnVsbGV0KSB7CiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZ2FtZUNvbnRleHQuc291bmRzLmRlc3Ryb3lbJ3BvaW50LXN0YXItZGVzdHJveSddLnBsYXkoKTsKCiAgICAgICAgICAgIGNvbXBvbmVudENvbnRleHQuZGVzdHJveVBvaW50U3RhcihpZCk7CgogICAgICAgICAgICAvLyBEaXNwb3NlIGJ1bGxldAogICAgICAgICAgICBidWxsZXQuc2V0QWN0aXZlKGZhbHNlKS5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICAgICAgYnVsbGV0LnkgPSAtMTAwOwogICAgICAgICAgICBidWxsZXQueCA9IC0xMDA7CiAgICAgICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgLy8gU2hpcCBjb2xsaXNpb24KICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnBoeXNpY3MuYWRkLm92ZXJsYXAoCiAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmdhbWVDb250ZXh0LnNoaXAsCiAgICAgICAgICBvYmplY3QsCiAgICAgICAgICBmdW5jdGlvbiAoc2hpcCwgb2JqZWN0KSB7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LnVwZGF0ZVNjb3JlKGNvbXBvbmVudENvbnRleHQuZ29vZE9iamVjdHMuZmlsdGVyKG9iaiA9PiBvYmoubmFtZSA9PT0gJ3BvaW50LXN0YXInKVswXS5wb2ludHMpOwoKICAgICAgICAgICAgY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5zb3VuZHNbJ3BvaW50LXN0YXInXVsKICAgICAgICAgICAgTWF0aC5mbG9vcigKICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogY29tcG9uZW50Q29udGV4dC5nYW1lQ29udGV4dC5zb3VuZHNbJ3BvaW50LXN0YXInXS5sZW5ndGgKICAgICAgICAgICAgKQogICAgICAgICAgICBdLnBsYXkoe3ZvbHVtZTogMC4yfSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb21wb25lbnRDb250ZXh0LmRlc3Ryb3lQb2ludFN0YXIoaWQpOwogICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIGNvbXBvbmVudENvbnRleHQuY3VycmVudFBvaW50U3RhcnMucHVzaChmaW5hbE9iamVjdCk7CiAgICAgIH0KICAgIH0KCiAgICAvLyBMb2FkIGxlYWRlcmJvYXJkIGRhdGEKICAgIC8vIGNvbXBvbmVudENvbnRleHQuZ2V0TGVhZGVyQm9hcmQoKTsKICB9LAp9Owo="},{"version":3,"sources":["Game.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6JA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Game.vue","sourceRoot":"src/components/pages","sourcesContent":["<template>\n  <div id=\"BUG\"\n      data-background=\"navy\">\n    <div\n      v-if=\"currentPage === 'dashboard'\"\n      id=\"Dashboard\"\n      class=\"Page\"\n      data-background=\"navy\"\n    >\n      <img src=\"@/assets/bug-logo.svg\" class=\"Logo\" />\n      <div class=\"Controls\">\n        <div class=\"Button\" data-color=\"magenta\" @click=\"changePage('game')\">\n          start\n        </div>\n        <div style=\"hide\"\n          class=\"Button\"\n          data-color=\"purple\"\n          @click=\"changePage('leaderboard')\"\n        >\n          leaderboard\n        </div>\n      </div>\n    </div>\n\n    <div\n      v-if=\"currentPage === 'level-select'\"\n      id=\"LevelSelect\"\n      class=\"Page\"\n      data-background=\"navy\"\n    >\n      <div class=\"Controls\">\n        <div class=\"Button\" data-color=\"purple\" @click=\"changePage('game')\">\n          go!\n        </div>\n      </div>\n    </div>\n\n    <div\n      v-if=\"currentPage === 'leaderboard'\"\n      id=\"Leaderboard\"\n      class=\"Page\"\n      data-background=\"navy\"\n    >\n\n\n    <!-- leaderboard table -->\n    <div class=\"LeaderBoard_Table\">\n      <div class=\"LeaderBoard_TableHeader\">top 10 worldwide</div>\n      <div class=\"LeaderBoard_TableBody\">\n        <table>\n          <tr class=\"LeaderBoard_Table_Entry\" v-for=\"(entry, index) in leaderBoardEntries\" :key=\"index\">\n            <td class=\"LeaderBoard_User\">{{ entry.user }}</td><td class=\"LeaderBoard_Score\">{{ entry.score }}</td>\n          </tr>\n        </table>\n      </div>\n    </div>\n\n      <div class=\"Controls\">\n        <div\n          v-if=\"gameStatus === 'over' || gameStatus === 'complete'\"\n          class=\"Button\"\n          data-color=\"magenta\"\n          @click=\"changePage('game')\"\n        >\n          go again!\n        </div>\n        <div\n          class=\"Button\"\n          data-color=\"purple\"\n          @click=\"changePage('dashboard')\"\n        >\n          dashboard\n        </div>\n      </div>\n    </div>\n\n    <div\n      v-if=\"currentPage === 'game'\"\n      id=\"Game\"\n      :class=\"{\n        Page: true,\n        shake: shakeScreenNow && currentLevel.shakeScreen === true\n      }\"\n      :data-status=\"gameStatus\"\n      :data-background=\"gameBackground\"\n      :data-audio-step=\"currentAudioStep\"\n    >\n      <!-- Game background -->\n      <div class=\"Audio_Background\" v-if=\"gameBackground === 'fx'\">\n          <!-- Frequency level bocks-->\n          <div v-for=\"(level,index) in audio.levels.perc\" :key=\"index\" :data-level=\"index\" :style=\"{opacity: audio.levels.perc[index] >= 80 ? audio.levels.perc[index] * 0.01 : 0.25}\"></div>\n      </div>\n\n      <!-- Phaser -->\n      <!--<ion-phaser :game.prop=\"gameConfig\" :initialize.prop=\"gameInitialization\"/>-->\n      <div id=\"PhaserGame\"></div>\n\n      <div class=\"PostGame_Overlay\" v-if=\"gameStatus === 'over' || gameStatus === 'complete'\">\n        <div class=\"PostGame_Message\" v-if=\"gameMessage\">\n          <div>{{ gameMessage }}</div>\n          <div v-if=\"highScore\" data-text-color=\"yellow\">{{ totalScore }}</div>\n        </div>\n        <div class=\"PostGame_Controls\">\n          <div class=\"Button\" data-color=\"magenta\" @click=\"initializeGame(true)\">\n            go again!\n          </div>\n\n          <div v-if=\"false\" \n            class=\"Button\"\n            data-color=\"purple\"\n            @click=\"changePage('leaderboard')\"\n          >\n            leaderboard\n          </div>\n\n          <div v-if=\"!highScore\" \n            class=\"Button\"\n            data-color=\"purple\"\n            @click=\"changePage('dashboard')\"\n          >\n            dashboard\n          </div>\n\n        </div>\n      </div>\n\n      <div class=\"HUD\">\n        <div class=\"HUD_Bottom\">\n          <div class=\"HUD_Bottom_Left\">\n\n            <div class=\"HUD_Life\">\n              <div\n                class=\"HUD_Lives\"\n                v-for=\"(live, index) in lives\"\n                :key=\"index\"\n              ></div>\n              <div class=\"HUD_LifeBar\" :data-level=\"lifeLevel\">\n                <div class=\"HUD_LifeBar_Fill\" :style=\"{\n                  width: life + '%'\n                }\"></div>\n              </div>\n            </div>\n\n          \n          </div>\n          <div class=\"HUD_Bottom_Right\">\n            <div class=\"TotalScore\">{{ totalScore }}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <audio style=\"display:none\" ref=\"soundPlayer\"></audio>\n  </div>\n</template>\n\n<script>\nimport Vue from \"vue\";\nimport Phaser from \"phaser\";\nimport { AudioFunctions } from \"../../mixins/AudioFunctions.js\";\n\nexport default {\n  name: \"Game\",\n  mixins: [AudioFunctions],\n  computed: {\n    highScore() {\n      const gotAHighScore = false;\n      return gotAHighScore;\n    },\n    shipAlive() {\n      return this.life > 0;\n    },\n    lifeLevel() {\n      const level = \n        this.life >= 75 ? 'high':\n        this.life >= 50 ? 'med':\n        'low';\n      return level;\n    },\n    totalScore() {\n      return this.$store.state.totalScore;\n    },\n    gameMessage() {\n      const message =\n        this.gameStatus === \"paused\"\n          ? \"paused\"\n          : this.gameStatus === \"error\"\n          ? \"error - refresh to start over\"\n          : this.gameStatus === \"over\"\n          ? \"you dead\"\n          : this.gameStatus === \"complete\" && this.highScore\n          ? \"high score\"\n          : this.gameStatus === 'complete' ?\n            \"more coming soon\"\n          : false;\n      return message;\n    },\n    leaderBoardEntries() {\n      const entries = this.$store.state.leaderBoardEntries;\n      return entries;\n    },\n    gameBackground() {\n      const color =\n        this.gameStatus === \"over\"\n          ? \"burgundy\"\n        : this.gameStatus === \"complete\"\n          ? \"navy\"\n          : this.currentLevel.background\n          ? this.currentLevel.background\n          : \"navy\";\n      return color;\n    },\n    currentAudioStep() {\n      return this.audio.bassSteps.current || 1;\n    },\n    shakeScreenNow () {\n      return this.audio.crazyBass === true\n    }\n  },\n  data() {\n    return {\n      currentPage: \"dashboard\",\n      gameInitialization: false,\n      gameConfig: {},\n      gameStatus: \"loading\",\n      gameAttempts: [],\n      life: 100,\n      lives: 3,\n\n      audio: {\n        bassSteps: {\n          current: 0,\n          count: 0,\n        },\n        levels: {}\n      },\n      levels: [\n        {\n          _id: 1,\n          filename: \"1\",\n          background: \"navy\",\n          gravity:50\n        },\n        {\n          _id: 2,\n          filename: \"2\",\n          background: \"purple\",\n          gravity:100\n        },\n\n        {\n          _id: 3,\n          filename: \"3\",\n          background: \"jazz\",\n          gravity:250,\n          shakeScreen: true\n        },\n\n        {\n          _id: 4,\n          filename: \"4\",\n          background: \"black\",\n          gravity:100\n        },\n\n        {\n          _id: 5,\n          filename: \"5\",\n          background: \"steps\",\n          gravity:200\n        },\n        /*\n        {\n          _id: 6,\n          filename: \"test\",\n          background: \"steps\",\n          gravity:1000\n        }*/\n      ],\n      \n\n      currentLevel: {},\n      currentDeathObjects: [],\n      currentPointStars: [],\n      bulletSpeed: 750,\n      goodObjects: [\n        {\n          name: \"point-star\",\n          width: 23,\n          height: 46 / 2,\n          points: 5,\n          prob: 1\n        },\n      ],\n      deathObjects: [\n        {\n          name: \"spiral\",\n          width: 47,\n          height: 45,\n          prob: 0.025\n        },\n        {\n          name: \"comet\",\n          width: 42,\n          height: 86 / 2,\n          points: 500,\n          prob: 0.3\n        },\n        {\n          name: \"stroid\",\n          width: 42,\n          height: 80 / 2,\n          points: 250,\n          prob: 0.5\n        },\n        {\n          name: \"star\",\n          width: 23,\n          height: 46 / 2,\n          points: 100,\n          prob: 1\n        },\n      ],\n      x: window.innerWidth / 2,\n      y: window.innerHeight - 50,\n      updateTime: 50,\n      updateTimer: 0,\n    };\n  },\n  methods: {\n    randomItemProbablity(options) {\n      const weightedOptions = options.sort(({prob:a}, {prob:b}) => a - b);\n      const randomNumber = Math.random();\n      let obj;\n      for (let i = 0; i < weightedOptions.length; i++) {\n        const prevWeight = i > 0 ? weightedOptions[i - 1].prob: 0;\n        if (\n          randomNumber > prevWeight && randomNumber <= weightedOptions[i].prob\n        ) {\n          obj = options[i] \n          break;\n        }\n      }\n      return obj;\n    },\n    randomNumber(min, max) {\n      return Math.random() * (max - min) + min;\n    },\n    systemSound(key) {\n      const sound = this.$refs.soundPlayer;\n      sound.src = 'audio/effects/'+key+'.mp3';\n      sound.play();\n    },\n    changePage(page) {\n      const componentContext = this;\n      this.currentPage = page;\n      componentContext.systemSound('button-select');\n\n      this.$nextTick(function () {\n        if (\n          componentContext.gameStatus === \"started\" ||\n          componentContext.gameStatus === \"over\" || \n          componentContext.gameStatus === \"complete\"\n        ) {\n          if (page !== \"game\") {\n          } else {\n            // Restart game\n            componentContext.initializeGame();\n          }\n        } else {\n          // First game\n          if (page === \"game\") {\n            componentContext.initializeGame();\n          }\n        }\n      });\n    },\n\n    removeAllObjects() {\n      const componentContext = this;\n        componentContext.currentDeathObjects.forEach(function (obj) {\n          obj.object.setActive(false).setVisible(false);\n          obj.object.destroy();\n        });\n        componentContext.currentDeathObjects = [];\n\n        componentContext.currentPointStars.forEach(function (obj) {\n          obj.object.setActive(false).setVisible(false);\n          obj.object.destroy();\n        });\n        componentContext.currentPointStars = [];\n    },\n    initializeGame(again) {\n      const componentContext = this;\n\n      if (again) {\n        componentContext.systemSound('button-select');\n      }\n\n      if (componentContext.destroyGame) {\n        componentContext.destroyGame.func();\n      }\n      this.gameStatus = \"loading\";\n      componentContext.currentLevel = componentContext.levels[0];\n      componentContext.updateScore(\"reset\");\n      componentContext.lives = 3;\n      componentContext.life = 100;\n\n      componentContext.phaserGame = new Phaser.Game(\n        componentContext.gameConfig\n      );\n      componentContext.gameInitialization = true;\n    },\n    endGame() {\n      const componentContext = this;\n      componentContext.removeAllObjects();\n      componentContext.stopSound(componentContext);\n      componentContext.gameStatus = \"complete\";\n      \n      // Add score\n      // Check high score\n    },\n    updateScore(points) {\n      this.$store.dispatch(\"updateScore\", points);\n    },\n    animateShip(gameContext, animation, override = false) {\n      const componentContext = this;\n      const animationReady =\n        override === true\n          ? true\n          : componentContext.shipAlive && gameContext.vulnerable\n          ? true\n          : animation === \"death\"\n          ? true\n          : false;\n      if (animationReady) {\n        gameContext.ship.play(animation);\n      }\n    },\n    shipFloat(gameContext) {\n      const componentContext = this;\n      if (componentContext.shipAlive) {\n        componentContext.animateShip(gameContext, \"float\");\n      }\n    },\n    destroyPointStar(id) {\n      const componentContext = this;\n      const obj = componentContext.currentPointStars.filter(pointStar => pointStar.id === id);\n      const index = componentContext.currentPointStars.findIndex(\n        (pointStar) => pointStar.id === id\n      );\n      if (index > -1) {\n        obj[0].object.setActive(false);\n        obj[0].object.setVisible(false);\n        obj[0].object.destroy();\n\n        componentContext.currentPointStars.splice(index, 1);\n      }\n      },\n    destroyObject(obj) {\n      const componentContext = this;\n      componentContext.gameContext.sounds.destroy[obj.name].play();\n\n      if (obj.name === \"stroid\") {\n        obj.object.clearTint();\n      }\n      obj.object.play(\"destroy-\" + obj.name);\n      obj.object.notAThreat = true;\n      setTimeout(function () {\n        componentContext.removeObject(obj);\n      }, 500);\n    },\n    removeObject(obj) {\n      const componentContext = this;\n      const index = componentContext.currentDeathObjects.findIndex(\n        (deathObject) => deathObject.id === obj.id\n      );\n      if (index > -1) {\n        obj.object.setActive(false);\n        obj.object.setVisible(false);\n        obj.object.destroy();\n        componentContext.currentDeathObjects.splice(index, 1);\n      }\n    },\n    shipLife(gameContext, amount, objectName) {\n      const componentContext = this;\n      function resetVulnerability() {\n        clearTimeout(gameContext.vulnerabilityTimer);\n        gameContext.vulnerable = false;\n        gameContext.vulnerabilityTimer = setTimeout(function () {\n          gameContext.vulnerable = true;\n        }, 1500);\n      }\n      function lifeCheck() {\n        componentContext.lives -= 1;\n        if (componentContext.lives < 1) {\n          componentContext.gameStatus = \"over\";\n          componentContext.stopSound(componentContext);\n        } else {\n          componentContext.addShip(gameContext);\n        }\n      }\n      \n      if (amount === \"restore\") {\n        componentContext.life = 100;\n        componentContext.animateShip(gameContext, \"restore\");\n      } else {\n        if (gameContext.vulnerable) {\n          if (amount !== \"death\") {\n            // Take damage\n            if (amount < 0) {\n              if (objectName && gameContext.sounds.damage[objectName]) {\n                gameContext.sounds.damage[objectName].play();\n              }\n\n              componentContext.life -= amount * -1;\n              componentContext.animateShip(gameContext, \"damage\");\n            }\n\n            // Add life\n            else if (amount > 0) {\n              componentContext.life += amount;\n            }\n          }\n\n          // If dead\n          if (amount === \"death\" || !componentContext.shipAlive) {\n            if (objectName) {\n              gameContext.sounds.death[objectName].play();\n            }\n\n            gameContext.vulnerable = false;\n            clearTimeout(gameContext.vulnerabilityTimer);\n            componentContext.life = 0;\n            componentContext.animateShip(gameContext, \"death\");\n            setTimeout(function () {\n              componentContext.removeAllObjects();\n              lifeCheck();\n            }, 2000);\n          } else {\n            resetVulnerability();\n          }\n        }\n      }\n    },\n    addShip(gameContext) {\n      const componentContext = this;\n      componentContext.systemSound('ship-entrance');\n\n      if (componentContext.gameContext.ship) {\n        componentContext.gameContext.ship.setActive(false).setVisible(false);\n        componentContext.gameContext.ship.destroy();\n        componentContext.gameContext.ship = {};\n      }\n      gameContext.ship = gameContext.physics.add\n        .sprite(componentContext.x, componentContext.y, \"ship\")\n        .setDepth(1);\n      gameContext.ship.body.setAllowGravity(false);\n      componentContext.life = 100;\n      gameContext.vulnerable = true;\n      componentContext.shipFloat(gameContext);\n\n      gameContext.physics.add.overlap(\n        gameContext.bullets,\n        gameContext.ship,\n        function (object, bullet) {\n          if (bullet.friendlyFire) {\n            componentContext.shipLife(gameContext, -25, \"bullet\");\n            bullet.setActive(false).setVisible(false);\n          }\n        }\n      );\n    },\n\n    startLevel() {\n      const componentContext = this;\n\n      // Set level gravity\n      if (componentContext.currentLevel.gravity) {\n        componentContext.gameContext.physics.world.gravity.y = componentContext.currentLevel.gravity;\n      }\n\n      // Play beat\n      componentContext.playBeat(componentContext);\n    },\n    getLeaderBoard() {\n      var componentContext = this;\n      componentContext.$store.dispatch('getLeaderBoard');\n    }\n  },\n  mounted() {\n    const componentContext = this;\n    componentContext.gameConfig = {\n      parent: \"PhaserGame\",\n      width: window.innerWidth,\n      height: window.innerHeight,\n      transparent: true,\n      type: Phaser.AUTO,\n      scene: {\n        physics: {\n          arcade: {\n            debug: false,\n            gravity: { x: 0, y: 50 },\n          },\n          matter: {\n            gravity: { y: 0 },\n          },\n        },\n        init() {\n          //this.cameras.main.setBackgroundColor('transparent'); // Set background color\n        },\n        preload() {\n          const context = this;\n          componentContext.gameContext = this;\n\n          // LOAD ARTWORK\n\n          // Ship and Weapons\n          context.load.spritesheet(\"ship\", \"image/ship.svg\", {\n            frameWidth: 50,\n            height: 50,\n          });\n          context.load.image(\"bullet\", \"image/ship-bullet.svg\");\n\n          // Life Objects\n          context.load.image(\"lifebase\", \"image/lifebase.svg\", {\n            frameWidth: 60,\n            height: 40,\n          });\n\n          // Death objects\n          componentContext.deathObjects.forEach(function (objectObj, index) {\n            const objectName = \"death-\" + objectObj.name;\n            context.load.spritesheet(\n              objectName,\n              \"image/\" + objectName + \".svg\",\n              {\n                frameWidth: objectObj.width,\n                frameHeight: objectObj.height,\n              }\n            );\n          });\n\n          // Good objects\n          componentContext.goodObjects.forEach(function (objectObj, index) {\n            const objectName = objectObj.name;\n            context.load.spritesheet(\n              objectName,\n              \"image/\" + objectName + \".svg\",\n              {\n                frameWidth: objectObj.width,\n                frameHeight: objectObj.height,\n              }\n            );\n          });\n\n          // Sound Effects\n          /*context.load.audio(\"continue\", [\n            \"audio/effects/continue.ogg\",\n            \"audio/effects/continue.mp3\",\n          ]);\n          context.load.audio(\"go\", [\n            \"audio/effects/go.ogg\",\n            \"audio/effects/go.mp3\",\n          ]);*/\n\n          // Weapons\n          context.load.audio(\"gun-1\", [\n            \"audio/effects/gun-1.ogg\",\n            \"audio/effects/gun-1.mp3\",\n          ]);\n          context.load.audio(\"gun-2\", [\n            \"audio/effects/gun-2.ogg\",\n            \"audio/effects/gun-2.mp3\",\n          ]);\n\n          // Damage\n          context.load.audio(\"damage-star\", [\n            \"audio/effects/damage-star.ogg\",\n            \"audio/effects/damage-star.mp3\",\n          ]);\n          context.load.audio(\"damage-bullet\", [\n            \"audio/effects/damage-bullet.ogg\",\n            \"audio/effects/damage-bullet.mp3\",\n          ]);\n\n          // Death\n          context.load.audio(\"destroy-comet\", [\n            \"audio/effects/destroy-comet.ogg\",\n            \"audio/effects/destroy-comet.mp3\",\n          ]);\n          context.load.audio(\"destroy-stroid\", [\n            \"audio/effects/destroy-stroid.ogg\",\n            \"audio/effects/destroy-stroid.mp3\",\n          ]);\n          context.load.audio(\"destroy-star\", [\n            \"audio/effects/destroy-star.ogg\",\n            \"audio/effects/destroy-star.mp3\",\n          ]);\n          context.load.audio(\"spiral-ricochet\", [\n            \"audio/effects/spiral-ricochet.ogg\",\n            \"audio/effects/spiral-ricochet.mp3\",\n          ]);\n\n          // Death\n          context.load.audio(\"death-comet\", [\n            \"audio/effects/death-comet.ogg\",\n            \"audio/effects/death-comet.mp3\",\n          ]);\n          context.load.audio(\"death-stroid\", [\n            \"audio/effects/death-stroid.ogg\",\n            \"audio/effects/death-stroid.mp3\",\n          ]);\n          context.load.audio(\"death-star\", [\n            \"audio/effects/death-star.ogg\",\n            \"audio/effects/death-star.mp3\",\n          ]);\n          context.load.audio(\"death-spiral\", [\n            \"audio/effects/death-spiral.ogg\",\n            \"audio/effects/death-spiral.mp3\",\n          ]);\n          context.load.audio(\"death-bullet\", [\n            \"audio/effects/death-bullet.ogg\",\n            \"audio/effects/death-bullet.mp3\",\n          ]);\n\n          // Good\n          /*\n          context.load.audio(\"lifebase\", [\n            \"audio/effects/lifebase.ogg\",\n            \"audio/effects/lifebase.mp3\",\n          ]);*/\n          context.load.audio(\"point-star-1\", [\n            \"audio/effects/point-star-1.ogg\",\n            \"audio/effects/point-star-1.mp3\",\n          ]);\n          context.load.audio(\"point-star-2\", [\n            \"audio/effects/point-star-2.ogg\",\n            \"audio/effects/point-star-2.mp3\",\n          ]);\n          context.load.audio(\"point-star-3\", [\n            \"audio/effects/point-star-3.ogg\",\n            \"audio/effects/point-star-3.mp3\",\n          ]);\n          context.load.audio(\"point-star-4\", [\n            \"audio/effects/point-star-4.ogg\",\n            \"audio/effects/point-star-4.mp3\",\n          ]);\n          context.load.audio(\"point-star-destroy\", [\n            \"audio/effects/point-star-destroy.ogg\",\n            \"audio/effects/point-star-destroy.mp3\",\n          ]);\n\n        },\n        create() {\n          const context = this;\n          \n          // Store reset function\n          componentContext.destroyGame = {\n            func: function () {\n              context.sys.game.destroy(true);\n            },\n          };\n\n          // Animations\n          context.anims.create({\n            key: \"float\",\n            frameRate: 5,\n            frames: this.anims.generateFrameNumbers(\"ship\", {\n              start: 2,\n              end: 2,\n            }),\n            repeat: -0,\n          });\n          context.anims.create({\n            key: \"go\",\n            frameRate: 5,\n            frames: this.anims.generateFrameNumbers(\"ship\", {\n              start: 3,\n              end: 3,\n            }),\n            repeat: -1,\n          });\n          context.anims.create({\n            key: \"restore\",\n            frameRate: 10,\n            frames: this.anims.generateFrameNumbers(\"ship\", { frames: [0, 2] }),\n            repeat: 3,\n          });\n          context.anims.create({\n            key: \"damage\",\n            frameRate: 10,\n            frames: this.anims.generateFrameNumbers(\"ship\", { frames: [1, 2] }),\n            repeat: 3,\n          });\n          context.anims.create({\n            key: \"death\",\n            frameRate: 5,\n            frames: this.anims.generateFrameNumbers(\"ship\", {\n              start: 4,\n              end: 4,\n            }),\n            repeat: -0,\n          });\n\n          // Weapons\n          context.bullets = new Bullets(context);\n          context.input.on(\"pointerdown\", (pointer) => {\n            if (componentContext.shipAlive) {\n              this.bullets.fireBullet(this.ship.x, this.ship.y - 20);\n            }\n          });\n\n          // Add ship\n          componentContext.addShip(context);\n\n          // Good objects\n          componentContext.goodObjects.forEach(function (objectObj, index) {\n            const objectName = objectObj.name;\n              context.anims.create({\n                key: objectName,\n                frameRate: 1,\n                frames: context.anims.generateFrameNumbers(objectName, {\n                  start: 1,\n                  end: 1,\n                }),\n                repeat: -0,\n              });\n          });\n\n          // Death objects\n          componentContext.deathObjects.forEach(function (objectObj, index) {\n            const objectName = \"death-\" + objectObj.name;\n            if (objectObj.name != \"spiral\") {\n              context.anims.create({\n                key: \"destroy-\" + objectObj.name,\n                frameRate: 1,\n                frames: context.anims.generateFrameNumbers(objectName, {\n                  start: 1,\n                  end: 1,\n                }),\n                repeat: -0,\n              });\n            }\n          });\n\n\n          // Load sound effects\n          context.sounds = {\n            button: {\n              // select: context.sound.add(\"select\"),\n              //continue: context.sound.add(\"continue\"),\n              //go: context.sound.add(\"go\")\n            },\n            'point-star': [context.sound.add(\"point-star-1\"), context.sound.add(\"point-star-2\"),context.sound.add(\"point-star-3\"),context.sound.add(\"point-star-4\")],\n            gun: [context.sound.add(\"gun-1\"), context.sound.add(\"gun-2\")],\n            death: {\n              comet: context.sound.add(\"death-comet\"),\n              stroid: context.sound.add(\"death-stroid\"),\n              star: context.sound.add(\"death-star\"),\n              spiral: context.sound.add(\"death-spiral\"),\n              bullet: context.sound.add(\"death-bullet\"),\n            },\n            destroy: {\n              comet: context.sound.add(\"destroy-comet\"),\n              stroid: context.sound.add(\"destroy-stroid\"),\n              star: context.sound.add(\"destroy-star\"),\n              \"spiral-ricochet\": context.sound.add(\"spiral-ricochet\"),\n              \"point-star-destroy\": context.sound.add(\"point-star-destroy\"),\n            },\n            damage: {\n              star: context.sound.add(\"damage-star\"),\n              bullet: context.sound.add(\"damage-bullet\"),\n            },\n          };\n\n          // Start music 🎵🎵🎵\n          componentContext.startLevel();\n          componentContext.gameStatus = \"started\";\n        },\n        update(time, delta) {\n          const context = this;\n          let { width, height } = context.sys.game.canvas;\n\n          if (componentContext.gameStatus !== \"over\" && componentContext.gameStatus !== \"complete\") {\n            while (\n              !componentContext.updateTimer ||\n              time > componentContext.updateTimer + componentContext.updateTime\n            ) {\n              const spawnPadding = 20;\n              \n              \n              // Point stars\n              if (\n                componentContext.currentPointStars.length <= 20\n              ) {\n                  const pointStarX = Phaser.Math.Between(\n                    spawnPadding,\n                    context.game.config.width - spawnPadding\n                  );\n                  let pointStar = new PointStar(\n                    context,\n                    pointStarX,\n                    0\n                  );\n              }\n              \n\n              // Death objects\n              if (\n                componentContext.audio.midBass &&\n                componentContext.currentDeathObjects.length < 15\n              ) {\n                const objectType = componentContext.randomItemProbablity(componentContext.deathObjects);\n                const objectName = objectType.name;                \n                const xPosition = Phaser.Math.Between(\n                  spawnPadding,\n                  context.game.config.width - spawnPadding\n                );\n\n                // Send object\n                let deathObject = new DeathObject(\n                  context,\n                  xPosition,\n                  0,\n                  objectName\n                );\n              }\n              \n              componentContext.updateTimer = time; // Reset timer\n            }\n\n            // Death spirals\n            componentContext.currentDeathObjects\n              .filter((object) => object.name === \"spiral\")\n              .forEach(function (spiral) {\n                spiral.object.rotation += 0.125;\n              });\n\n            // Death by spiral\n            if (\n              componentContext.life === 0 &&\n              context.deathBySpiral &&\n              context.deathBySpiral.object\n            ) {\n              context.ship.setOrigin(0.5, 0.5);\n              context.ship.angle += 25;\n              context.physics.moveToObject(\n                context.ship,\n                context.deathBySpiral.object,\n                500\n              );\n              if (context.ship.scale > 0) {\n                context.ship.scale -= 0.1;\n              } else {\n                context.ship.scale = 0;\n                componentContext.shipLife(context, \"death\");\n                context.deathBySpiral = false;\n              }\n            }\n\n            // Process point stars\n            componentContext.currentPointStars.forEach(function (\n              pointStar\n            ) {\n              if (pointStar) {\n                const objectPosition = {\n                  x: pointStar.object.x,\n                  y: pointStar.object.y,\n                };\n                if (\n                  objectPosition.y >\n                    componentContext.gameContext.game.config.height ||\n                  objectPosition.y < 0\n                ) {\n                  componentContext.destroyPointStar(pointStar.id);                  \n                }\n              }\n            });\n          \n\n            // Process Death objects\n            componentContext.currentDeathObjects.forEach(function (\n              deathObject\n            ) {\n              if (deathObject) {\n                const objectPosition = {\n                  x: deathObject.object.x,\n                  y: deathObject.object.y,\n                };\n                if (\n                  objectPosition.y >\n                    componentContext.gameContext.game.config.height ||\n                  objectPosition.y < 0\n                ) {\n                  componentContext.removeObject(deathObject);\n                  if (\n                    componentContext.shipAlive &&\n                    context.movementScoreTrigger\n                  ) {\n                    componentContext.updateScore(10);\n                  }\n                }\n              }\n            });\n          }\n        },\n      },\n    };\n\n    const bottomPadding = 50;\n    document.addEventListener(\"mousemove\", function (evt) {\n      if (componentContext.gameContext) {\n        // Check if game ready\n\n        // Animation\n        const stallTime = 500;\n        componentContext.animateShip(componentContext.gameContext, \"go\"); // Acceleration animation\n        setTimeout(function () {\n          componentContext.shipFloat(componentContext.gameContext); // Float after stall time\n        }, stallTime);\n\n        // Follow mouse\n        if (componentContext.gameContext.ship && componentContext.shipAlive) {\n          const flyConfig = {\n            targets: componentContext.gameContext.ship,\n            x: evt.clientX,\n            duration: 250,\n            ease: \"Sine.easeOut\",\n          };\n\n          if (componentContext.gameStatus === 'complete' || evt.clientY >= componentContext.gameContext.game.config.height / 2 && evt.clientY <= componentContext.gameContext.game.config.height - bottomPadding\n          ) {\n            flyConfig.y = evt.clientY;\n          }\n          componentContext.gameContext.tweens.add(flyConfig, this);\n\n          // Movement score control\n          const campingTime = 5000;\n          clearTimeout(componentContext.gameContext.movementScoreTimer);\n          componentContext.gameContext.movementScoreTrigger = true;\n          componentContext.gameContext.movementScoreTimer = setTimeout(\n            function () {\n              componentContext.gameContext.movementScoreTrigger = false;\n            },\n            campingTime\n          );\n        }\n      }\n    });\n\n    class Bullet extends Phaser.Physics.Arcade.Sprite {\n      constructor(scene, x, y) {\n        super(scene, x, y, \"bullet\");\n      }\n\n      fire(x, y) {\n        this.rotation = 0;\n        this.friendlyFire = false;\n        this.richochetDecided = false;\n        this.body.reset(x, y);\n\n        this.setActive(true);\n        this.setVisible(true);\n\n        this.setVelocityY(componentContext.bulletSpeed * -1);\n      }\n\n      preUpdate(time, delta) {\n        super.preUpdate(time, delta);\n\n        if (\n          this.y < 0 ||\n          this.y > componentContext.gameContext.game.config.height\n        ) {\n          this.setActive(false);\n          this.setVisible(false);\n          this.y = -100;\n          this.x = -100;\n        }\n      }\n    }\n    class Bullets extends Phaser.Physics.Arcade.Group {\n      constructor(scene) {\n        super(scene.physics.world, scene);\n\n        this.createMultiple({\n          frameQuantity: 7,\n          key: \"bullet\",\n          active: false,\n          visible: false,\n          classType: Bullet,\n        });\n      }\n\n      fireBullet(x, y) {\n        let bullet = this.getFirstDead(false);\n        if (bullet) {\n          // Play random gun sound\n          componentContext.gameContext.sounds.gun[\n            Math.floor(\n              Math.random() * componentContext.gameContext.sounds.gun.length\n            )\n          ].play();\n\n          bullet.fire(x, y);\n        }\n      }\n    }\n    class DeathObject extends Phaser.Physics.Arcade.Sprite {\n      constructor(scene, x, y, name) {\n        const objectName = \"death-\" + name;\n        const id = Date.now();\n        const depth = name === 'spiral' ? -1: 0;\n        super(scene, x, y, objectName);\n        const object = this.scene.physics.add\n          .sprite(x, y, objectName)\n          .setDepth(depth);\n        const finalObject = {\n          object: object,\n          name: name,\n          id: id,\n        };\n\n        // Comet\n        if (name === \"comet\") {\n          // Heat seaking at random\n          const heatSeek = Math.random() < 0.1;\n          if (heatSeek) {\n            finalObject.heatSeek = true;\n            const rotation = componentContext.gameContext.physics.accelerateTo(\n              object,\n              componentContext.gameContext.ship.x,\n              componentContext.gameContext.ship.y,\n              componentContext.randomNumber(250, 750)\n            );\n            object.rotation = rotation - 90; // Hack to fix incorrect rotation;\n            finalObject.points = 1500;\n          } else {\n            object.setVelocityY(componentContext.randomNumber(100, 650));\n          }\n        }\n\n        if (name === \"stroid\") {\n          var randomScale = componentContext.randomNumber(0.75, 1.25)\n          object.scale = randomScale;\n          const randomColor = Math.random() * 0xffffff;\n          object.setTint(randomColor,randomColor,randomColor,randomColor);\n        }\n\n        if (name === \"spiral\") {\n          object.scale = 1.5;\n        }\n\n        // Bullet collision\n        componentContext.gameContext.physics.add.overlap(\n          componentContext.gameContext.bullets,\n          object,\n          function (object, bullet) {\n            if (!object.notAThreat) {\n              if (name === \"spiral\") {\n                if (!bullet.richochetDecided) {\n                  var randomRicochet = Math.random() < 0.5;\n                  bullet.richochetDecided = true;\n                  if (randomRicochet) {\n                    componentContext.gameContext.sounds.destroy[\n                      \"spiral-ricochet\"\n                    ].play();\n                    bullet.friendlyFire = true;\n                    bullet.rotation += 0.5;\n                    bullet.setVelocityY(componentContext.bulletSpeed * 0.75);\n                  }\n                }\n              } else {\n                const pointsEarned = finalObject.points\n                  ? finalObject.points\n                  : componentContext.deathObjects.filter(\n                      (obj) => obj.name === name\n                    )[0].points;\n                componentContext.updateScore(pointsEarned);\n                componentContext.destroyObject(finalObject);\n\n                // Dispose bullet\n                bullet.setActive(false).setVisible(false);\n                bullet.y = -100;\n                bullet.x = -100;\n              }\n            }\n          }\n        );\n\n        // Ship collision\n        componentContext.gameContext.physics.add.overlap(\n          componentContext.gameContext.ship,\n          object,\n          function (ship, object) {\n            if (!object.notAThreat && componentContext.gameContext.vulnerable) {\n              if (name === \"spiral\") {\n                componentContext.gameContext.sounds.death.spiral.play();\n                componentContext.life = 0;\n                componentContext.gameContext.deathBySpiral = {\n                  object: object,\n                };\n              } else {\n                if (name === \"star\") {\n                  componentContext.shipLife(\n                    componentContext.gameContext,\n                    -10,\n                    name\n                  );\n                } \n                else if (name === \"comet\" && !finalObject.heatSeek) {\n                  componentContext.shipLife(\n                    componentContext.gameContext,\n                    -50,\n                    name\n                  );\n                } else {\n                  componentContext.gameContext.sounds.death[name].play();\n                  componentContext.shipLife(\n                    componentContext.gameContext,\n                    \"death\"\n                  );\n                }\n                componentContext.destroyObject(finalObject);\n              }\n            }\n          }\n        );\n\n        componentContext.currentDeathObjects.push(finalObject);\n      }\n    }\n\n    class PointStar extends Phaser.Physics.Arcade.Sprite {\n      constructor(scene, x, y,) {\n        const objectName = 'point-star';\n        const id = Date.now();\n        super(scene, x, y);\n        const object = this.scene.physics.add\n          .sprite(x, y, 'point-star')\n          .setDepth(0);\n        const finalObject = {\n          object: object,\n          name: name,\n          id: id,\n        };        \n\n        // Bullet collision\n        componentContext.gameContext.physics.add.overlap(\n          componentContext.gameContext.bullets,\n          object,\n          function (object, bullet) {\n            componentContext.gameContext.sounds.destroy['point-star-destroy'].play();\n\n            componentContext.destroyPointStar(id);\n\n            // Dispose bullet\n            bullet.setActive(false).setVisible(false);\n            bullet.y = -100;\n            bullet.x = -100;\n          }\n        );\n\n        // Ship collision\n        componentContext.gameContext.physics.add.overlap(\n          componentContext.gameContext.ship,\n          object,\n          function (ship, object) {\n            \n            componentContext.updateScore(componentContext.goodObjects.filter(obj => obj.name === 'point-star')[0].points);\n\n            componentContext.gameContext.sounds['point-star'][\n            Math.floor(\n              Math.random() * componentContext.gameContext.sounds['point-star'].length\n            )\n            ].play({volume: 0.2});\n            \n            componentContext.destroyPointStar(id);\n          }\n        );\n\n        componentContext.currentPointStars.push(finalObject);\n      }\n    }\n\n    // Load leaderboard data\n    // componentContext.getLeaderBoard();\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import url(\"https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@600&display=swap\");\n\n@font-face {\n  font-family: \"MAG-Font\";\n  src: url(\"~@/assets/fonts/MAG-Font.woff2\") format(\"woff2\"),\n    url(\"~@/assets/fonts/MAG-Font.woff\") format(\"woff\"),\n    url(\"~@/assets/fonts/MAG-Font.ttf\") format(\"truetype\");\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n@font-face {\n  font-family: \"MAG-Font\";\n  src: url(\"~@/assets/fonts/MAG-Font_1.woff2\") format(\"woff2\"),\n    url(\"~@/assets/fonts/MAG-Font_1.woff\") format(\"woff\"),\n    url(\"~@/assets/fonts/MAG-Font_1.ttf\") format(\"truetype\");\n  font-weight: normal;\n  font-style: normal;\n  font-display: swap;\n}\n\n// Game\n#BUG {\n  position: relative;\n  height: 100%;\n  width: 100%;\n  transition: background-color 2.5s;\n  font-family: \"Roboto Mono\", monospace;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\n.Page {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  text-align: center;\n  transition: background-color 2.5s;\n}\n#Dashboard {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.Logo {\n  display: block;\n  margin: 0 auto;\n  margin-bottom: 40px;\n}\n#PhaserGame {\n  cursor: crosshair;\n}\n\n// HUD\n.PostGame_Overlay {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  text-align: center;\n}\n.PostGame_Message {\n  font-family: \"MAG-Font\";\n  font-size: 7.5em;\n  color: white;\n}\n.HUD_Bottom {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n\n  .HUD_Bottom_Left {\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n    flex-grow: 1;\n    text-align: left;\n  }\n  .HUD_Bottom_Right {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    flex-grow: 1;\n    text-align: right;\n  }\n\n  .HUD_Life {\n    padding: 0 10px;\n  }\n  .HUD_LifeBar {\n    height: 5px;\n    .HUD_LifeBar_Fill{\n      transition: all 0.1s;\n      height: 100%;\n    }\n    &[data-level=\"high\"] {\n      .HUD_LifeBar_Fill{\n        background: rgba(255, 255, 255, 0.45);\n      }\n    }\n    &[data-level=\"med\"] {\n      .HUD_LifeBar_Fill{\n        background: #FCE00A;\n      }\n    }\n    &[data-level=\"low\"] {\n      .HUD_LifeBar_Fill{\n        background: #EF3A65;\n      }\n    }\n  }\n  .HUD_Lives {\n    width: 25px;\n    height: 20px;\n    background: url(\"~@/assets/hud-life.svg\");\n    display: inline-block;\n    margin: 0 5px;\n  }\n}\n.TotalScore {\n  font-family: \"MAG-Font\";\n  font-size: 100px;\n  color: #fce00a;\n}\n\n.Controls {\n  display: inline-flex;\n  flex-direction: column;\n}\n.Button {\n  cursor: pointer;\n  display: table;\n  font-family: \"Roboto Mono\";\n  font-size: 20px;\n  font-weight: 600;\n  box-shadow: -4px 4px 0px 3px #00b7ff;\n  background: blue;\n  color: white;\n  padding: 12.5px 20px;\n  margin-bottom: 15px;\n  transition: transform 0.1s;\n\n  &[data-color=\"magenta\"] {\n    background-color: #8b0975;\n  }\n  &[data-color=\"purple\"] {\n    background-color: #380762;\n  }\n\n  &:hover {\n    transform: scale(1.05);\n  }\n}\n\n[data-background=\"violet\"] {\n  background-color: #202a51;\n}\n[data-background=\"navy\"] {\n  background-color: #1e2235;\n}\n[data-background=\"jazz\"] {\n  background-color: #16235b;\n}\n[data-background=\"purple\"] {\n  background-color: #341c47;\n}\n[data-background=\"black\"] {\n  background-color: #000;\n}\n[data-background=\"fx\"] {\n  background-color: rgba(0, 0, 0, 0.692);\n}\n[data-background=\"steps\"] {\n  transition: background-color 0.1s;\n  &[data-audio-step=\"1\"] {\n    background: #160C1E;\n  }\n  &[data-audio-step=\"2\"] {\n    background: #060F2D;\n  }\n  &[data-audio-step=\"3\"] {\n    background: #031723;\n  }\n  &[data-audio-step=\"4\"] {\n    background: #060321;\n  }\n  &[data-audio-step=\"5\"] {\n    background: #001151;\n  }\n  &[data-audio-step=\"6\"] {\n    background: #1F0438;\n  }\n}\n\n.Audio_Background {\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  transition: all 0.5s;\n  -webkit-transition: all 0.5s;\n  z-index: -1;\n\n  flex-wrap: wrap;\n  [data-level] {\n    opacity: 0;\n    flex-grow: 1;\n    min-width: 50px;\n  }\n  [data-level=\"0\"],\n  [data-level=\"1\"],\n  [data-level=\"2\"] {\n    background: #ff7887;\n  }\n  [data-level=\"2\"],\n  [data-level=\"3\"],\n  [data-level=\"4\"],\n  [data-level=\"5\"],\n  [data-level=\"6\"],\n  [data-level=\"7\"] {\n    background: #ffa371;\n  }\n  [data-level=\"8\"],\n  [data-level=\"9\"],\n  [data-level=\"10\"],\n  [data-level=\"11\"],\n  [data-level=\"12\"],\n  [data-level=\"13\"] {\n    background: #fff06d;\n  }\n  [data-level=\"9\"],\n  [data-level=\"10\"],\n  [data-level=\"11\"],\n  [data-level=\"12\"],\n  [data-level=\"13\"],\n  [data-level=\"14\"] {\n    background: #d8ff83;\n  }\n  [data-level=\"15\"],\n  [data-level=\"16\"],\n  [data-level=\"17\"],\n  [data-level=\"18\"],\n  [data-level=\"19\"],\n  [data-level=\"20\"] {\n    background: #73c0ff;\n  }\n  [data-level=\"21\"],\n  [data-level=\"22\"],\n  [data-level=\"23\"],\n  [data-level=\"24\"],\n  [data-level=\"25\"],\n  [data-level=\"26\"] {\n    background: #bc88ff;\n  }\n  [data-level=\"27\"],\n  [data-level=\"28\"],\n  [data-level=\"29\"],\n  [data-level=\"30\"],\n  [data-level=\"31\"],\n  [data-level=\"32\"] {\n    background: #ff8be6;\n  }\n}\n\n[data-background=\"burgundy\"] {\n  background-color: #42061a;\n  transition: background-color 0.5s;\n  .Button {\n    &[data-color=\"magenta\"] {\n      background-color: #cc3154;\n    }\n    &[data-color=\"purple\"] {\n      background-color: #380762;\n    }\n    box-shadow: -4px 4px 0px 3px #fce00a;\n  }\n}\n\n[data-text-color=\"yellow\"] {\n  color: #fce00a;\n}\n\n.shake {\n\t-webkit-animation: shake 0.05s linear infinite both;\n\t        animation: shake 0.05s linear infinite both;\n}\n@keyframes shake {\n  0% {\n    -webkit-transform: translate(0);\n            transform: translate(0);\n  }\n  20% {\n    -webkit-transform: translate(-5px, 5px);\n            transform: translate(-5px, 5px);\n  }\n  40% {\n    -webkit-transform: translate(-5px, 5px);\n            transform: translate(-5px, 5px);\n  }\n  60% {\n    -webkit-transform: translate(5px, 5px);\n            transform: translate(5px, 5px);\n  }\n  80% {\n    -webkit-transform: translate(5px, 5px);\n            transform: translate(5px, 5px);\n  }\n  100% {\n    -webkit-transform: translate(0);\n            transform: translate(0);\n  }\n}\n\n.LeaderBoard_Table {\n  font-family: \"Roboto Mono\";\n  background: #1E2235;\n  color: white;\n  margin: 20px;\n\n}\n.LeaderBoard_TableHeader {\n  background: #2D3B70;\n  font-family: \"MAG-Font\";\n  font-size: 60px;\n  padding: 5px 10px;\n}\n.LeaderBoard_TableBody {\n background: #370C45;\n table {\n   width: 100%;\n   border-collapse: collapse;\n }\n}\n.LeaderBoard_Table_Entry {\n  padding: 5px 10px;\n  &:nth-child(odd) {background: #3A4F93;}\n  &:nth-child(even) {background: #2D3B70;}\n  &[data-user-entry] {\n    color: #fce00a;\n  }\n  font-size: 20px;\n}\n.LeaderBoard_User {\n\n}\n.LeaderBoard_Score {\n\n}\n</style>\n"]}]}